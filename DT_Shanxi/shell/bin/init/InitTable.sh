#!/bin/bash
#结果库
DDLDB=$1
#结果库中的外部路径
DB_PATH=$2
#原始库
BaseDB=$3
#原始库外部路径
BasePath=$4


WAREHOUSE="user/hive/warehouse/$DDLDB.db"
#sh VolumeAnalyseInitTable.sh shanxi  'datang'

hive<<EOF

CREATE DATABASE IF NOT EXISTS ${DDLDB};
USE ${DDLDB};

DROP TABLE IF EXISTS tb_xdr_ifc_http_new;
CREATE EXTERNAL TABLE tb_xdr_ifc_http_new(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior int,
  wtpinterrupttype int,
  wtpinterruptcause int,
  title string,
  keyword string,
  busconductlogo int,
  buscompletionflag int,
  busrede int,
  browsingtool int,
  portalapp int,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_http';

--20170627新增
drop table lte_cellmr_source;
create table lte_cellmr_source(
objectid string,
  vid bigint,
  fileformatversion string,
  starttime bigint,
  endtime bigint,
  period bigint,
  enbid bigint,
  userlabel string,
  mrname string,
  cellid bigint,
  earfcn bigint,
  subframenbr bigint,
  prbnbr bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  meatime string,
  eventtype string,
  gridcenterlongitude string,
  gridcenterlatitude string,
  kpi1 bigint,
  kpi2 bigint,
  kpi3 bigint,
  kpi4 bigint,
  kpi5 bigint,
  kpi6 bigint,
  kpi7 bigint,
  kpi8 bigint,
  kpi9 bigint,
  kpi10 bigint,
  kpi11 bigint,
  kpi12 bigint,
  kpi13 bigint,
  kpi14 bigint,
  kpi15 bigint,
  kpi16 bigint,
  kpi17 bigint,
  kpi18 bigint,
  kpi19 bigint,
  kpi20 bigint,
  kpi21 bigint,
  kpi22 bigint,
  kpi23 bigint,
  kpi24 bigint,
  kpi25 bigint,
  kpi26 bigint,
  kpi27 bigint,
  kpi28 bigint,
  kpi29 bigint,
  kpi30 bigint,
  kpi31 bigint,
  kpi32 bigint,
  kpi33 bigint,
  kpi34 bigint,
  kpi35 bigint,
  kpi36 bigint,
  kpi37 bigint,
  kpi38 bigint,
  kpi39 bigint,
  kpi40 bigint,
  kpi41 bigint,
  kpi42 bigint,
  kpi43 bigint,
  kpi44 bigint,
  kpi45 bigint,
  kpi46 bigint,
  kpi47 bigint,
  kpi48 bigint,
  kpi49 bigint,
  kpi50 bigint,
  kpi51 bigint,
  kpi52 bigint,
  kpi53 bigint,
  kpi54 bigint,
  kpi55 bigint,
  kpi56 bigint,
  kpi57 bigint,
  kpi58 bigint,
  kpi59 bigint,
  kpi60 bigint,
  kpi61 bigint,
  kpi62 bigint,
  kpi63 bigint,
  kpi64 bigint,
  kpi65 bigint,
  kpi66 bigint,
  kpi67 bigint,
  kpi68 bigint,
  kpi69 bigint,
  kpi70 bigint,
  kpi71 bigint,
  length bigint,
  city string,
  xdrtype bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  mrtype bigint,
  neighborcellnumber bigint,
  gsmneighborcellnumber bigint,
  tdsneighborcellnumber bigint,
  v_enb bigint,
  mrtime bigint
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--业务占比表
drop table business_type_detail;
create EXTERNAL table business_type_detail(
        TTIME              string,
        city               string,
        region             string,
        app_type           int,
        app_sub_type       int,
        uldata             bigint,
        dldata             bigint,
        counts             bigint,
        timespan           bigint,
        succCnt           bigint,
        dltime           bigint,
        resptime           bigint,
        respsucccnt        bigint
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/business_type_detail';

--volte用户表
drop table if exists volte_user_data;
CREATE  TABLE IF NOT EXISTS volte_user_data(
  ttime string,
  hours int,
  imsi string, 
  volte_start int, 
  volte_end int)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',';

--高铁用户识别表
drop table if exists volte_gtuser_data;
create EXTERNAL table if not exists volte_gtuser_data(
imsi string,
cellid string,
ttime string
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster//${DB_PATH}/output/xdrnew/volte_gtuser_data';

-- 小区统计表(分钟级)
drop table if exists gt_pulse_detail;
create table if not exists gt_pulse_detail(
ttime string,
hours int,
minutes int,
cellid bigint,
imsi string,
imei string,
gtuser_flag int,
volteuser_flag int,
sub_pulse_mark int)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;



--子脉冲统计表(分钟级)
drop table if exists  gt_pulse_cell_min;
create table if not exists gt_pulse_cell_min(
ttime string,
hours int,
minutes int,
cellid bigint,
sub_pulse_mark int,
sub_pulse_type int,
users bigint,
gt_users bigint,
comm_users bigint,
volte_users bigint)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

--脉冲统计小时表
drop table if exists gt_pulse_cell_base60;
create table if not exists gt_pulse_cell_base60(
     ttime string,
     hours int,
     cellid bigint,
     pulse_mark bigint,
     pulse_type bigint,
     pulse_timelen bigint,
     first_pulse_mark bigint,
     sub_users_peak bigint,
     sub_gtusers_peak bigint,
     sub_volteusers_peak bigint,
     sub_commusers_peak bigint,
     users bigint,
     gt_users bigint,
     volte_users bigint)
PARTITIONED BY ( 
  dt string,
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;


--脉冲明细小时表
drop table  if exists gt_pulse_detail_base60;
create table if not exists gt_pulse_detail_base60(
ttime string,
hours int,
cellid bigint,
imsi string,
pulse_mark bigint,
pulse_type bigint,
pulse_timelen bigint,
first_pulse_mark bigint,
gtuser_flag bigint,
volteuser_flag bigint)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

--城市高铁用户频段表
drop table gt_freq_baseday;
create table if not exists gt_freq_baseday(
     line_name  string,
     city string,
     ttime string,
     cell_feq string,
     cell_num int,
     gtusers int,
     commusers int,
     cellavguses int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;



DROP TABLE   IF EXISTS LTE_MRO_SOURCE;
create EXTERNAL table   IF NOT EXISTS LTE_MRO_SOURCE
(
       objectID       STRING ,
       VID             BIGINT  ,
       fileFormatVersion STRING ,
       startTime       STRING  ,
       endTime         STRING ,
       period          BIGINT ,
       enbID           BIGINT,
       userLabel      STRING ,
       mrName         STRING ,
       cellID          BIGINT ,
       Earfcn          BIGINT ,
       SubFrameNbr     BIGINT ,
       PRBNbr          BIGINT ,
       MmeUeS1apId     BIGINT ,
       MmeGroupId      BIGINT ,
       MmeCode         BIGINT ,
       meaTime         STRING ,
       EventType      STRING ,
       gridcenterLongitude   STRING,
       gridcenterLatitude    STRING,
       kpi1            BIGINT ,
       kpi2            BIGINT ,
       kpi3            BIGINT ,
       kpi4            BIGINT ,
       kpi5            BIGINT ,
       kpi6            BIGINT ,
       kpi7            BIGINT ,
       kpi8            BIGINT ,
       kpi9            BIGINT ,
       kpi10           BIGINT ,
       kpi11           BIGINT ,
       kpi12           BIGINT ,
       kpi13           BIGINT ,
       kpi14           BIGINT ,
       kpi15           BIGINT ,
       kpi16           BIGINT ,
       kpi17           BIGINT ,
       kpi18           BIGINT ,
       kpi19           BIGINT ,
       kpi20           BIGINT ,
       kpi21           BIGINT ,
       kpi22           BIGINT ,
       kpi23           BIGINT ,
       kpi24           BIGINT ,
       kpi25           BIGINT ,
       kpi26           BIGINT ,
       kpi27           BIGINT ,
       kpi28           BIGINT ,
       kpi29           BIGINT ,
       kpi30           BIGINT ,
       kpi31           BIGINT ,
       kpi32           BIGINT ,
       kpi33           BIGINT ,
       kpi34           BIGINT ,
       kpi35           BIGINT ,
       kpi36           BIGINT ,
       kpi37           BIGINT ,
       kpi38           BIGINT ,
       kpi39           BIGINT ,
       kpi40           BIGINT ,
       kpi41           BIGINT ,
       kpi42           BIGINT ,
       kpi43           BIGINT ,
       kpi44           BIGINT ,
       kpi45           BIGINT ,
       kpi46           BIGINT ,
       kpi47           BIGINT ,
       kpi48           BIGINT ,
       kpi49           BIGINT ,
       kpi50           BIGINT ,
       kpi51           BIGINT ,
       kpi52           BIGINT ,
       kpi53           BIGINT ,
       kpi54           BIGINT ,
       kpi55           BIGINT ,
       kpi56           BIGINT ,
       kpi57           BIGINT ,
       kpi58           BIGINT ,
       kpi59           BIGINT ,
       kpi60           BIGINT ,
       kpi61           BIGINT ,
       kpi62           BIGINT ,
       kpi63           BIGINT ,
       kpi64           BIGINT ,
       kpi65           BIGINT ,
       kpi66           BIGINT ,
       kpi67           BIGINT ,
       kpi68           BIGINT ,
       kpi69           BIGINT ,
       kpi70           BIGINT ,
       kpi71           BIGINT ,
       length          BIGINT ,
       City            STRING ,
       XDRType         BIGINT ,
       Interface       BIGINT ,
       XDRID          STRING ,
       RAT             BIGINT ,
       IMSI           STRING ,
       IMEI           STRING ,
       MSISDN         STRING ,
       MRType          BIGINT ,
       NeighborCellNumber BIGINT ,
       gsmNeighborCellNumber   BIGINT ,
       tdsNeighborCellNumber   BIGINT ,
       v_enb BIGINT,
     mrtime   BIGINT
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${DB_PATH}/LTE_MRO_SOURCE';


DROP TABLE  IF EXISTS TB_XDR_IFC_GMMWMGMIMJISC;
CREATE EXTERNAL TABLE  IF NOT EXISTS TB_XDR_IFC_GMMWMGMIMJISC (
      LENGTH                        BIGINT,
      CITY                         STRING,
      INTERFACE                     BIGINT,
      XDRID                        STRING,
      RAT                           BIGINT,
      IMSI                         STRING,
      IMEI                         STRING,
      MSISDN                       STRING,
      PROCEDURETYPE                 BIGINT,
      PROCEDURESTARTTIME           BIGINT,
      PROCEDUREENDTIME             BIGINT,
      SERVICETYPE                   BIGINT,
      PROCEDURESTATUS               BIGINT,
      CALLINGNUMBER                STRING,
      CALLEDNUMBER                 STRING,
      CALLINGPARTYURI              STRING,
      REQUESTURI                   STRING,
      USERIP                       STRING,
      CALLID                       STRING,
      ICID                         STRING,
      SOURCENEIP                   STRING,
      SOURCENEPORT                  BIGINT,
      DESTNEIP                     STRING,
      DESTNEPORT                    BIGINT,
      CALLSIDE                      BIGINT,
      SOURCEACCESSTYPE              BIGINT,
      SOURCEECI                     BIGINT,
      SOURCETAC                     BIGINT,
      SOURCEIMSI                   STRING,
      SOURCEIMEI                   STRING,
      DESTACCESSTYPE                BIGINT,
      DESTECI                       BIGINT,
      DESTTAC                       BIGINT,
      DESTIMSI                     STRING,
      DESTIMEI                     STRING,
      AUTHTYPE                      BIGINT,
      EXPIRESTIMEREQ               BIGINT,
      EXPIRESTIMERSP               BIGINT,
      CALLINGSDPIPADDR             STRING,
      CALLINGAUDIOSDPPORT           BIGINT,
      CALLINGVIDEOSDPPORT           BIGINT,
      CALLEDSDPIPADDR              STRING,
      CALLEDAUDIOSDPPORT            BIGINT,
      CALLEDVIDEOPORT               BIGINT,
      AUDIOCODEC                    BIGINT,
      VIDEOCODEC                    BIGINT,
      REDIRECTINGPARTYADDRESS      STRING,
      ORIGINALPARTYADDRESS         STRING,
      REDIRECTREASON                BIGINT,
      RESPONSECODE                  BIGINT,
      FINISHWARNINGCODE             BIGINT,
      FINISHREASONPROTOCOL          BIGINT,
      FINISHREASONCAUSE             BIGINT,
      FIRFAILTIME                  BIGINT,
      FIRSTFAILNEIP                STRING,
      ALERTINGTIME                 BIGINT,
      ANSWERTIME                   BIGINT,
      RELEASETIME                  BIGINT,
      CALLDURATION                  BIGINT,
      AUTHREQTIME                  BIGINT,
      AUTHRSPTIME                  BIGINT,
      STNSR                        STRING,
      ATCFMGMT                     STRING,
      ATUSTI                       STRING,
      CMSISDN                      STRING,
      SSI                          STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${DB_PATH}/TB_XDR_IFC_GMMWMGMIMJISC';


drop table tac_hour_http;
CREATE EXTERNAL TABLE tac_hour_http(
ttime                        string,
tac                         string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/tac_hour_http';

drop table tac_day_http;
CREATE EXTERNAL TABLE tac_day_http(
ttime                        string,
tac                         string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/tac_day_http';

drop table cell_hour_http;
CREATE EXTERNAL TABLE cell_hour_http(
ttime                        string,
cellid                      bigint,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp           bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp              bigint,
AppStoreAppStoredownflow         bigint,
AppStoreAppStoredowntime          bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime         bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/cell_hour_http';

drop table cell_day_http;
CREATE EXTERNAL TABLE cell_day_http(
ttime                        string,
cellid                      bigint,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp           bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp              bigint,
AppStoreAppStoredownflow         bigint,
AppStoreAppStoredowntime          bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime         bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/cell_day_http';


drop table sp_hour_http;
CREATE EXTERNAL TABLE sp_hour_http(
ttime                        string,
appserveripipv4        string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc            bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sp_hour_http';

drop table sp_day_http;
CREATE EXTERNAL TABLE sp_day_http(
ttime                        string,
appserveripipv4        string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc            bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sp_day_http';


drop table ue_hour_http;
CREATE EXTERNAL TABLE ue_hour_http(
ttime                        string,
imsi                        string,
msisdn                      string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp           bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow          bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/ue_hour_http';


drop table ue_day_http;
CREATE EXTERNAL TABLE ue_day_http(
ttime                        string,
imsi                        string,
msisdn                      string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp           bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow          bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/ue_day_http';

drop table imsi_cell_hour_http;
CREATE EXTERNAL TABLE imsi_cell_hour_http(
ttime                        string,
imsi                        string,
msisdn                      string,
cellid                      bigint,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc             bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/imsi_cell_hour_http';

drop table imsi_cell_day_http;
CREATE EXTERNAL TABLE imsi_cell_day_http(
ttime                        string,
imsi                        string,
msisdn                      string,
cellid                      bigint,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits           bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc             bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/imsi_cell_day_http';

drop table sgw_hour_http;
CREATE EXTERNAL TABLE sgw_hour_http(
ttime                        string,
sgwipaddr                   string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits            bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sgw_hour_http';

drop table sgw_day_http;
CREATE EXTERNAL TABLE sgw_day_http(
ttime                        string,
sgwipaddr                   string,
browsedownloadvisits       bigint,
videoservicevisits         bigint,
instantmessagevisits       bigint,
appvisits                  bigint,
browsedownloadbusiness     bigint,
videoservicebusiness       bigint,
instantmessagebusiness     bigint,
appbusiness                bigint,
dnsQuerySucc               bigint,
dnsQueryAtt                bigint,
tcpSetupSucc               bigint,
tcpSetupReq                bigint,
BearerULTCPRetransmit      bigint,
BearerULTCPTransmit        bigint,
BearerDLTCPRetransmit      bigint,
BearerDLTCPTransmit        bigint,
BearerULTCPMissequence     bigint,
BearerDLTCPMissequence     bigint,
pageresp                   bigint,
pagereq                    bigint,
pageresptimeall            bigint,
pageshowsucc               bigint,
pageshowtimeall            bigint,
httpdownflow               bigint,
httpdowntime               bigint,
mediasucc                  bigint,
mediareq                   bigint,
mediadownflow               double,
mediadowntime              bigint,
ServiceIMSucc              bigint,
ServiceIMReq               bigint,
readvisits                 bigint,
wbvisits                   bigint,
navigationvisits           bigint,
musicvisits                bigint,
gamevisits                 bigint,
payvisits                  bigint,
Animevisits                bigint,
mailvisits                 bigint,
p2pvisits                  bigint,
voipvisits                 bigint,
MultimediaMsgvisits        bigint,
financialvisits            bigint,
securityvisits             bigint,
shoppingvisits             bigint,
travelvisits               bigint,
cloudstoragevisits         bigint,
othervisits                bigint,
readbusiness               bigint,
wbbusiness                 bigint,
navigationbusiness         bigint,
musicbusiness              bigint,
gamebusiness               bigint,
paybusiness                bigint,
Animebusiness              bigint,
mailbusiness               bigint,
p2pbusiness                bigint,
voipbusiness               bigint,
MultimediaMsgbusiness      bigint,
financialbusiness          bigint,
securitybusiness           bigint,
shoppingbusiness           bigint,
travelbusiness             bigint,
cloudstoragebusiness       bigint,
otherbusiness              bigint,
mediaRespTimeall           bigint,
mediaResp                  bigint,
ServiceIMTrans             bigint,
ServiceIMFlow               double,
ServiceIMTime              bigint,
readsucc                   bigint,
readreq                    bigint,
readresptimeall            bigint,
readresp                   bigint,
readdownflow               bigint,
readdowntime               bigint,
wbsucc                     bigint,
wbreq                      bigint,
wbresptimeall              bigint,
wbresp                     bigint,
wbdownflow                 bigint,
wbdowntime                 bigint,
navigationsucc             bigint,
navigationreq              bigint,
navigationresptimeall      bigint,
navigationresp             bigint,
navigationdownflow         bigint,
navigationdowntime         bigint,
musicsucc                  bigint,
musicreq                   bigint,
musicresptimeall           bigint,
musicresp                  bigint,
musicdownflow              bigint,
musicdowntime              bigint,
appsucc                    bigint,
appreq                     bigint,
appresptimeall             bigint,
appresp                    bigint,
appdownflow                bigint,
appdowntime                bigint,
gamesucc                   bigint,
gamereq                    bigint,
gameresptimeall            bigint,
gameresp                   bigint,
gamedownflow               bigint,
gamedowntime               bigint,
paysucc                    bigint,
payreq                     bigint,
payresptimeall             bigint,
payresp                    bigint,
paydownflow                bigint,
paydowntime                bigint,
Animesucc                  bigint,
Animereq                   bigint,
Animeresptimeall           bigint,
Animeresp                  bigint,
Animedownflow              bigint,
Animedowntime              bigint,
mailsucc                   bigint,
mailreq                    bigint,
mailresptimeall            bigint,
mailresp                   bigint,
maildownflow               bigint,
maildowntime               bigint,
P2Psucc                    bigint,
P2Preq                     bigint,
P2Presptimeall             bigint,
P2Presp                    bigint,
P2Pdownflow                bigint,
P2Pdowntime                bigint,
VoIPsucc                   bigint,
VoIPreq                    bigint,
VoIPresptimeall            bigint,
VoIPresp                   bigint,
VoIPdownflow               bigint,
VoIPdowntime               bigint,
MultimediaMsgsucc          bigint,
MultimediaMsgreq           bigint,
MultimediaMsgresptimeall   bigint,
MultimediaMsgresp          bigint,
MultimediaMsgdownflow      bigint,
MultimediaMsgdowntime      bigint,
financialsucc              bigint,
financialreq               bigint,
financialresptimeall       bigint,
financialresp              bigint,
financialdownflow          bigint,
financialdowntime          bigint,
securitysucc               bigint,
securityreq                bigint,
securityresptimeall        bigint,
securityresp               bigint,
securitydownflow           bigint,
securitydowntime           bigint,
shoppingsucc               bigint,
shoppingreq                bigint,
shoppingresptimeall        bigint,
shoppingresp               bigint,
shoppingdownflow           bigint,
shoppingdowntime           bigint,
travelsucc                 bigint,
travelreq                  bigint,
travelresptimeall          bigint,
travelresp                 bigint,
traveldownflow             bigint,
traveldowntime             bigint,
cloudstoragesucc           bigint,
cloudstoragereq            bigint,
cloudstorageresptimeall    bigint,
cloudstorageresp           bigint,
cloudstoragedownflow       bigint,
cloudstoragedowntime       bigint,
internetsucc               bigint,
internetreq                bigint,
internetresptimeall        bigint,
internetresp               bigint,
internetdownflow           bigint,
internetdowntime           bigint,
migusucc                   bigint,
migureq                    bigint,
miguresptimeall            bigint,
miguresp                   bigint,
migudownflow               bigint,
migudowntime               bigint,
othersucc                  bigint,
otherreq                   bigint,
otherresptimeall           bigint,
otherresp                  bigint,
otherdownflow              bigint,
otherdowntime              bigint,
instantmessageTime         bigint,
readTime                   bigint,
wbTime                     bigint,
navigationTime             bigint,
videoserviceTime           bigint,
musicTime                  bigint,
appTime                    bigint,
gameTime                   bigint,
payTime                    bigint,
AnimeTime                  bigint,
mailTime                   bigint,
p2pTime                    bigint,
voipTime                   bigint,
MultimediaMsgTime          bigint,
browsedownloadTime         bigint,
financialTime              bigint,
securityTime               bigint,
shoppingTime               bigint,
travelTime                 bigint,
cloudstorageTime           bigint,
internetTime               bigint,
miguTime                   bigint,
otherTime                  bigint,
browsesurfresp                     bigint,
browsesurfreq                      bigint,
browsesurfresptimeall              bigint,
browsesurfshowsucc                 bigint,
browsesurfshowtimeall              bigint,
browsesurfdownflow                 bigint,
browsesurfdowntime                 bigint,
browsesurfFlow                     bigint,
browsesurfTime                     bigint,
browsetencentresp                  bigint,
browsetencentreq                   bigint,
browsetencentresptimeall           bigint,
browsetencentshowsucc              bigint,
browsetencentshowtimeall           bigint,
browsetencentdownflow              bigint,
browsetencentdowntime              bigint,
browsetencentFlow                  bigint,
browsetencentTime                  bigint,
browseqqNewsresp                   bigint,
browseqqNewsreq                    bigint,
browseqqNewsresptimeall            bigint,
browseqqNewsshowsucc               bigint,
browseqqNewsshowtimeall            bigint,
browseqqNewsdownflow               bigint,
browseqqNewsdowntime               bigint,
browseqqNewsFlow                   bigint,
browseqqNewsTime                   bigint,
browsetoutiaoresp                  bigint,
browsetoutiaoreq                   bigint,
browsetoutiaoresptimeall           bigint,
browsetoutiaoshowsucc              bigint,
browsetoutiaoshowtimeall           bigint,
browsetoutiaodownflow              bigint,
browsetoutiaodowntime              bigint,
browsetoutiaoFlow                  bigint,
browsetoutiaoTime                  bigint,
browseChromeresp                   bigint,
browseChromereq                    bigint,
browseChromeresptimeall            bigint,
browseChromeshowsucc               bigint,
browseChromeshowtimeall            bigint,
browseChromedownflow               bigint,
browseChromedowntime               bigint,
browseChromeFlow                   bigint,
browseChromeTime                   bigint,
otherhttpresp                      bigint,
otherhttpreq                       bigint,
otherhttpresptimeall               bigint,
otherhttpshowsucc                  bigint,
otherhttpshowtimeall               bigint,
otherhttpdownflow                  bigint,
otherhttpdowntime                  bigint,
otherhttpFlow                      bigint,
otherhttpTime                      bigint,
videomobileTVsucc                  bigint,
videomobileTVreq                   bigint,
videomobileTVresptimeall           bigint,
videomobileTVresp                  bigint,
videomobileTVdownflow              bigint,
videomobileTVdowntime              bigint,
videomobileTVFlow                  bigint,
videomobileTVTime                  bigint,
videomiguvideosucc                 bigint,
videomiguvideoreq                  bigint,
videomiguvideoresptimeall          bigint,
videomiguvideoresp                 bigint,
videomiguvideodownflow             bigint,
videomiguvideodowntime             bigint,
videomiguvideoFlow                 bigint,
videomiguvideoTime                 bigint,
videoiqiyisucc                     bigint,
videoiqiyireq                      bigint,
videoiqiyiresptimeall              bigint,
videoiqiyiresp                     bigint,
videoiqiyidownflow                 bigint,
videoiqiyidowntime                 bigint,
videoiqiyiFlow                     bigint,
videoiqiyiTime                     bigint,
imFechatsucc                       bigint,
imFechatreq                        bigint,
imFechatresptimeall                bigint,
imFechatresp                       bigint,
imFechatdownflow                   bigint,
imFechatdowntime                   bigint,
imFechatFlow                       bigint,
imFechatTime                       bigint,
imFetionsucc                       bigint,
imFetionreq                        bigint,
imFetionresptimeall                bigint,
imFetionresp                       bigint,
imFetiondownflow                   bigint,
imFetiondowntime                   bigint,
imFetionFlow                       bigint,
imFetionTime                       bigint,
imQQsucc                           bigint,
imQQreq                            bigint,
imQQresptimeall                    bigint,
imQQresp                           bigint,
imQQdownflow                       bigint,
imQQdowntime                       bigint,
imQQFlow                           bigint,
imQQTime                           bigint,
imwechatsucc                       bigint,
imwechatreq                        bigint,
imwechatresptimeall                bigint,
imwechatresp                       bigint,
imwechatdownflow                   bigint,
imwechatdowntime                   bigint,
imwechatFlow                       bigint,
imwechatTime                       bigint,
readcmreadsucc                     bigint,
readcmreadreq                      bigint,
readcmreadresptimeall              bigint,
readcmreadresp                     bigint,
readcmreaddownflow                 bigint,
readcmreaddowntime                 bigint,
readcmreadFlow                     bigint,
readcmreadTime                     bigint,
readsurfsucc                       bigint,
readsurfreq                        bigint,
readsurfresptimeall                bigint,
readsurfresp                       bigint,
readsurfdownflow                   bigint,
readsurfdowntime                   bigint,
readsurtFlow                       bigint,
readsurfTime                       bigint,
readQQReadsucc                     bigint,
readQQReadreq                      bigint,
readQQReadresptimeall              bigint,
readQQReadresp                     bigint,
readQQReaddownflow                 bigint,
readQQReaddowntime                 bigint,
readQQReadFlow                     bigint,
readQQReadTime                     bigint,
weibo139wbsucc                     bigint,
weibo139wbreq                      bigint,
weibo139wbresptimeall              bigint,
weibo139wbresp                     bigint,
weibo139wbdownflow                 bigint,
weibo139wbdowntime                 bigint,
weibo139wbFlow                     bigint,
weibo139wbTime                     bigint,
weibosinaWeibosucc                 bigint,
weibosinaWeiboreq                  bigint,
weibosinaWeiboresptimeall          bigint,
weibosinaWeiboresp                 bigint,
weibosinaWeibodownflow             bigint,
weibosinaWeibodowntime             bigint,
weibosinaWeiboFlow                 bigint,
weibosinaWeiboTime                 bigint,
navigationheMapsucc                bigint,
navigationheMapreq                 bigint,
navigationheMapresptimeall         bigint,
navigationheMapresp                bigint,
navigationheMapdownflow            bigint,
navigationheMapdowntime            bigint,
navigationheMapFlow                bigint,
navigationheMapTime                bigint,
navigationaMapsucc                 bigint,
navigationaMapreq                  bigint,
navigationaMapresptimeall          bigint,
navigationaMapresp                 bigint,
navigationaMapdownflow             bigint,
navigationaMapdowntime             bigint,
navigationaMapFlow                 bigint,
navigationaMapTime                 bigint,
musicmigumusicsucc                 bigint,
musicmigumusicreq                  bigint,
musicmigumusicresptimeall          bigint,
musicmigumusicresp                 bigint,
musicmigumusicdownflow             bigint,
musicmigumusicdowntime             bigint,
musicmigumusicFlow                 bigint,
musicmigumusicTime                 bigint,
musicqqmusicsucc                   bigint,
musicqqmusicreq                    bigint,
musicqqmusicresptimeall            bigint,
musicqqmusicresp                   bigint,
musicqqmusicdownflow               bigint,
musicqqmusicdowntime               bigint,
musicqqmusicFlow                   bigint,
musicqqmusicTime                   bigint,
AppStoreMobileMarketsucc           bigint,
AppStoreMobileMarketreq            bigint,
AppStoreMobileMarketresptimeall    bigint,
AppStoreMobileMarketresp          bigint,
AppStoreMobileMarketdownflow       bigint,
AppStoreMobileMarketdowntime       bigint,
AppStoreMobileMarketFlow           bigint,
AppStoreMobileMarketTime           bigint,
AppStoreAppStoresucc               bigint,
AppStoreAppStorereq                bigint,
AppStoreAppStoreresptimeall        bigint,
AppStoreAppStoreresp               bigint,
AppStoreAppStoredownflow           bigint,
AppStoreAppStoredowntime           bigint,
AppStoreAppStoreFlow               bigint,
AppStoreAppStoreTime               bigint,
GamemiguGamesucc                   bigint,
GamemiguGamereq                    bigint,
GamemiguGameresptimeall            bigint,
GamemiguGameresp                   bigint,
GamemiguGamedownflow               bigint,
GamemiguGamedowntime               bigint,
GamemiguGameFlow                   bigint,
GamemiguGameTime                   bigint,
Game4399Gamesucc                   bigint,
Game4399Gamereq                    bigint,
Game4399Gameresptimeall            bigint,
Game4399Gameresp                   bigint,
Game4399Gamedownflow               bigint,
Game4399Gamedowntime               bigint,
Game4399GameFlow                   bigint,
Game4399GameTime                   bigint,
PayNFCSIMsucc                      bigint,
PayNFCSIMreq                       bigint,
PayNFCSIMresptimeall               bigint,
PayNFCSIMresp                      bigint,
PayNFCSIMdownflow                  bigint,
PayNFCSIMdowntime                  bigint,
PayNFCSIMFlow                      bigint,
PayNFCSIMTime                      bigint,
PaymobilePaysucc                   bigint,
PaymobilePayreq                    bigint,
PaymobilePayresptimeall            bigint,
PaymobilePayresp                   bigint,
PaymobilePaydownflow               bigint,
PaymobilePaydowntime               bigint,
PaymobilePayFlow                   bigint,
PaymobilePayTime                   bigint,
PayNFCsucc                         bigint,
PayNFCreq                          bigint,
PayNFCresptimeall                  bigint,
PayNFCresp                         bigint,
PayNFCdownflow                     bigint,
PayNFCdowntime                     bigint,
PayNFCFlow                         bigint,
PayNFCTime                         bigint,
Animemigudmsucc                    bigint,
Animemigudmreq                     bigint,
Animemigudmresptimeall             bigint,
Animemigudmresp                    bigint,
Animemigudmdownflow                bigint,
Animemigudmdowntime                bigint,
AnimemigudmFlow                    bigint,
AnimemigudmTime                    bigint,
AnimeqqComicsucc                   bigint,
AnimeqqComicreq                    bigint,
AnimeqqComicresptimeall            bigint,
AnimeqqComicresp                   bigint,
AnimeqqComicdownflow               bigint,
AnimeqqComicdowntime               bigint,
AnimeqqComicFlow                   bigint,
AnimeqqComicTime                   bigint,
mail139mailsucc                    bigint,
mail139mailreq                     bigint,
mail139mailresptimeall             bigint,
mail139mailresp                    bigint,
mail139maildownflow                bigint,
mail139maildowntime                bigint,
mail139mailFlow                    bigint,
mail139mailTime                    bigint,
MailneteaseMailsucc                bigint,
MailneteaseMailreq                 bigint,
MailneteaseMailresptimeall         bigint,
MailneteaseMailresp                bigint,
MailneteaseMaildownflow            bigint,
MailneteaseMaildowntime            bigint,
MailneteaseMailFlow                bigint,
MailneteaseMailTime                bigint,
financialsjsjsucc                  bigint,
financialsjsjreq                   bigint,
financialsjsjresptimeall           bigint,
financialsjsjresp                  bigint,
financialsjsjdownflow              bigint,
financialsjsjdowntime              bigint,
financialsjsjFlow                  bigint,
financialsjsjTime                  bigint,
financialsjzqsucc                  bigint,
financialsjzqreq                   bigint,
financialsjzqresptimeall           bigint,
financialsjzqresp                  bigint,
financialsjzqdownflow              bigint,
financialsjzqdowntime              bigint,
financialsjzqFlow                  bigint,
financialsjzqTime                  bigint,
financialzixuangusucc              bigint,
financialzixuangureq               bigint,
financialzixuanguresptimeall       bigint,
financialzixuanguresp              bigint,
financialzixuangudownflow          bigint,
financialzixuangudowntime          bigint,
financialzixuanguFlow              bigint,
financialzixuanguTime              bigint,
Othergdqqtsucc                     bigint,
Othergdqqtreq                      bigint,
Othergdqqtresptimeall              bigint,
Othergdqqtresp                     bigint,
Othergdqqtdownflow                 bigint,
Othergdqqtdowntime                 bigint,
OthergdqqtFlow                     bigint,
OthergdqqtTime                     bigint,
Otherydzssucc                      bigint,
Otherydzsreq                       bigint,
Otherydzsresptimeall               bigint,
Otherydzsresp                      bigint,
Otherydzsdownflow                  bigint,
Otherydzsdowntime                  bigint,
OtherydzsFlow                      bigint,
OtherydzsTime                      bigint,
Othernxbstsucc                     bigint,
Othernxbstreq                      bigint,
Othernxbstresptimeall              bigint,
Othernxbstresp                     bigint,
Othernxbstdownflow                 bigint,
Othernxbstdowntime                 bigint,
OthernxbstFlow                     bigint,
OthernxbstTime                     bigint,
Othernxtsucc                       bigint,
Othernxtreq                        bigint,
Othernxtresptimeall                bigint,
Othernxtresp                       bigint,
Othernxtdownflow                   bigint,
Othernxtdowntime                   bigint,
OthernxtFlow                       bigint,
OthernxtTime                       bigint,
Otheryjtsucc                       bigint,
Otheryjtreq                        bigint,
Otheryjtresptimeall                bigint,
Otheryjtresp                       bigint,
Otheryjtdownflow                   bigint,
Otheryjtdowntime                   bigint,
OtheryjtFlow                       bigint,
OtheryjtTime                       bigint,
internetvisits                     bigint,
miguvisits                         bigint,
internetbusiness                   bigint,
migubusiness                       bigint,
ServiceIMresptimeall               bigint
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sgw_day_http';

drop table warnningtable;
CREATE EXTERNAL TABLE warnningtable(
City  int,
Cellid   bigint,
warnningtitle    string,
warnningtime     string,
effect           string
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/warnningtable';

drop table t_xdr_event_msg;
CREATE EXTERNAL TABLE t_xdr_event_msg(
City   String,
XDRID  string,
ProcedureStartTime bigint,
ttime string,
ProcedureEndTime  bigint,
IMSI             string,
IMEI             string,
TEtac             string,
msisdn              string,
Cellid           bigint,
SGW             string,
SP              string,
AppType         int,
AppSubtype      int,
AppStatus       int,
etype           string,
failurecase     string,
CELLREGION     string
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/t_xdr_event_msg';


drop table LTECELL;
create table LTECELL(
  MCC         int,
  MNC         INT,
  MMEGROUPID  INT,
  MMEID       int,
  ENODEBID    int,
  SITENAME    STRING,
  CELLNAME    STRING,
  LOCALCELLID int,
  CELLID      int,
  TAI         INT,
  PCI         INT,
  FREQ1       INT,
  FREQ2       INT,
  BANDWIDTH1  double,
  BANDWIDTH2  double,
  FREQCOUNT   INT,
  LONGITUDE   double,
  LATITUDE    double,
  SECTORTYPE  int,
  DOORTYPE    INT,
  TILTTOTAL   DOUBLE,
  TILTM       DOUBLE,
  TILTE       DOUBLE,
  AZIMUTH     DOUBLE,
  BEAMWIDTH   DOUBLE,
  VBEAMWIDTH  DOUBLE,
  AHEIGHT     DOUBLE,
  CITY        string,
  COMPANY     string,
  REGION      string,
  ENBTYPE     string,
  ENBVERSION  string
  )ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--门限配置表
 drop table if exists gt_capacity_config;
 create table if not exists gt_capacity_config(
        sub_pulse_limit int,
        non_gtsubpulse_commusers int,
        non_gtsubpuse_times int,
        over_pulse_timelen int,
        over_pulse_times int,
        short_pulse_timelen int,
        short_pulse_times int,
        balence_userrate int,
        balence_times int,
        highattach_users int,
        highattach_times int
 )
 PARTITIONED BY (
    dt string,
    h string
 )
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--负载均衡效果差小区天级表
drop table if exists gt_balence_baseday;
create table if not exists gt_balence_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        f1_f2 string,
        balenusesrateavg int,
        balenusersavg int
)
 PARTITIONED BY (
   dt string
 )
 ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--高铁用户脉冲时长超短小区表
drop table if exists gt_shorttimelen_baseday;
create table if not exists gt_shorttimelen_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        minpluse_timelen string,
        minhour int,
        maxpluse_timelen string,
        maxhour int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--高铁用户脉冲时长超长小区表
drop table if exists gt_overtimelen_baseday;
create table if not exists gt_overtimelen_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        minpluse_timelen int,
        minhour  int,
        maxpluse_timelen int,
        maxhour int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--平时普通用户多小区天级表
drop table if exists gt_commusermore_baseday;
create table if not exists gt_commusermore_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        maxusers int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--高冲击小区维度天级详细表
drop table if exists gt_highattach_baseday;
create table if not exists gt_highattach_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        maxusers int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

drop table if exists gt_pulse_load_balence60;
create table if not exists gt_pulse_load_balence60(
    ttime    string,
    hours    bigint,
    line    string,
    city    string,
    pulse_mark    bigint,
    cellprop    string,
    cellname    string,
    cellid    bigint,
    first_pulse_mark    bigint,
    pulse_timelen    bigint,
    pairname    string,
    f1users    bigint,
    f2users    bigint,
    balusers    bigint,
    balratio    double
)PARTITIONED BY (
       dt string,
       h string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ;

drop table if exists gt_balence_pair;
create table if not exists gt_balence_pair(
        line    string,
        city    string,
        scellname    string,
        scellid    bigint,
        sfreq    string,
        dcellname    string,
        dcellid    bigint,
        pairname    string,
        dfreq    string
)ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ;

drop table if exists tb_xdr_ifc_x2;
  CREATE EXTERNAL TABLE tb_xdr_ifc_x2(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  cellid bigint,
  targetcellid bigint,
  enbid bigint,
  targetenbid bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  requestcause bigint,
  failurecause bigint,
  epsbearernumber bigint,
  bearer0id bigint,
  bearer0status bigint,
  bearer1id bigint,
  bearer1status bigint,
  bearer2id bigint,
  bearer2status bigint,
  bearer3id bigint,
  bearer3status bigint,
  bearer4id bigint,
  bearer4status bigint,
  bearer5id bigint,
  bearer5status bigint,
  bearer6id bigint,
  bearer6status bigint,
  bearer7id bigint,
  bearer7status bigint,
  bearer8id bigint,
  bearer8status bigint,
  bearer9id bigint,
  bearer9status bigint,
  bearer10id bigint,
  bearer10status bigint,
  bearer11id bigint,
  bearer11status bigint,
  bearer12id bigint,
  bearer12status bigint,
  bearer13id bigint,
  bearer13status bigint,
  bearer14id bigint,
  bearer14status bigint,
  bearer15id bigint,
  bearer15status bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_X2' ;

drop table if exists tb_xdr_ifc_gxrx;
CREATE EXTERNAL TABLE tb_xdr_ifc_gxrx(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  icid string,
  originrealm string,
  destinationrealm string,
  originhost string,
  destinationhost string,
  sgsnsgwsigip string,
  afappid string,
  ccrequesttype bigint,
  rxrequesttype bigint,
  mediatype bigint,
  abortcause bigint,
  resultcode bigint,
  experimentalresultcode bigint,
  sessionreleasecause bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_GXRX' ;

drop table if exists tb_xdr_ifc_http;
  CREATE EXTERNAL TABLE tb_xdr_ifc_http(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior int,
  wtpinterrupttype int,
  wtpinterruptcause int,
  title string,
  keyword string,
  busconductlogo int,
  buscompletionflag int,
  busrede int,
  browsingtool int,
  portalapp int,
  parentxdrid string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
LOCATION
  'hdfs://dtcluster/${DB_PATH}/s1u_http_orgn' ;

drop table if exists mr_gt_grid_ana_base60;
CREATE TABLE mr_gt_grid_ana_base60(
  gridid int,
  ttime string,
  dir_state int,
  cellid int,
  rruid string,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_grid_ana_baseday;
 CREATE TABLE mr_gt_grid_ana_baseday(
  gridid int,
  ttime string,
  dir_state int,
  cellid int,
  rruid string,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table if exists volte_gt_cell_ana_base60;
CREATE TABLE volte_gt_cell_ana_base60(
  TTIME                  string,
  CELLID                 bigint,
  DIR_STATE              bigint,
  VOLTEMCSUCC            bigint,
  VOLTEMCATT             bigint,
  VOLTEVDSUCC            bigint,
  VOLTEVDATT             bigint,
  VOLTETIME              bigint,
  voltemctime            bigint,
voltemctimey             bigint,
voltevdtime              bigint,
voltevdtimey             bigint,
  VOLTEMCHANDOVER        bigint,
  VOLTEANSWER            bigint,
  VOLTEVDHANDOVER        bigint,
  VOLTEVDANSWER          bigint,
  SRVCCSUCC              bigint,
  SRVCCATT               bigint,
  SRVCCTIME              bigint,
  LTESWSUCC              bigint,
  LTESWATT               bigint,
  SRQATT                 bigint,
  SRQSUCC                bigint,
  TAUATT                 bigint,
  TAUSUCC                bigint,
  RRCREBUILD             bigint,
  RRCSUCC                bigint,
  RRCREQ                 bigint,
  IMSIREGATT             bigint,
  IMSIREGSUCC            bigint,
  WIRELESSDROP           bigint,
  WIRELESS               bigint,
  EABDROP                bigint,
  EAB                    bigint,
  EABS1SWX               bigint,
  EABS1SWY               bigint,
  S1TOX2SWX              bigint,
  S1TOX2SWY              bigint,
  ENBX2SWX               bigint,
  ENBX2SWY               bigint,
  UUENBSWX               bigint,
  UUENBSWY               bigint,
  UUENBINX               bigint,
  UUENBINY               bigint,
  SWX                    bigint,
  SWY                    bigint,
  ATTACHX                bigint,
  ATTACHY                bigint,
voltesucc                bigint,
srvccsuccS1              bigint
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';


drop table if exists volte_gt_cell_ana_baseday;
CREATE TABLE volte_gt_cell_ana_baseday(
   TTIME                  string,
  CELLID                 bigint,
  DIR_STATE              bigint,
  VOLTEMCSUCC            bigint,
  VOLTEMCATT             bigint,
  VOLTEVDSUCC            bigint,
  VOLTEVDATT             bigint,
  VOLTETIME              bigint,
  voltemctime            bigint,
voltemctimey             bigint,
voltevdtime              bigint,
voltevdtimey             bigint,
  VOLTEMCHANDOVER        bigint,
  VOLTEANSWER            bigint,
  VOLTEVDHANDOVER        bigint,
  VOLTEVDANSWER          bigint,
  SRVCCSUCC              bigint,
  SRVCCATT               bigint,
  SRVCCTIME              bigint,
  LTESWSUCC              bigint,
  LTESWATT               bigint,
  SRQATT                 bigint,
  SRQSUCC                bigint,
  TAUATT                 bigint,
  TAUSUCC                bigint,
  RRCREBUILD             bigint,
  RRCSUCC                bigint,
  RRCREQ                 bigint,
  IMSIREGATT             bigint,
  IMSIREGSUCC            bigint,
  WIRELESSDROP           bigint,
  WIRELESS               bigint,
  EABDROP                bigint,
  EAB                    bigint,
  EABS1SWX               bigint,
  EABS1SWY               bigint,
  S1TOX2SWX              bigint,
  S1TOX2SWY              bigint,
  ENBX2SWX               bigint,
  ENBX2SWY               bigint,
  UUENBSWX               bigint,
  UUENBSWY               bigint,
  UUENBINX               bigint,
  UUENBINY               bigint,
  SWX                    bigint,
  SWY                    bigint,
  ATTACHX                bigint,
  ATTACHY                bigint,
voltesucc                bigint,
srvccsuccS1              bigint)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table if exists volte_gt_user_ana_base60;
CREATE TABLE volte_gt_user_ana_base60(
    IMSI                   string,
  IMEI                   string,
  MSISDN                 string,
  CELLID                bigint,
  TTIME                  string,
  RAILLINE               string,
  DIR_STATE             bigint,
  VOLTEMCSUCC           bigint,
  VOLTEMCATT            bigint,
  VOLTEVDSUCC           bigint,
  VOLTEVDATT            bigint,
  VOLTETIME             bigint,
  VOLTEMCTIME           bigint,
  voltemctimey         bigint,
  VOLTEVDTIME           bigint,
  voltevdtimey        bigint,
  VOLTEMCHANDOVER       bigint,
  VOLTEANSWER           bigint,
  VOLTEVDHANDOVER       bigint,
  VOLTEVDANSWER         bigint,
  SRVCCSUCC             bigint,
  SRVCCATT              bigint,
  SRVCCTIME             bigint,
  LTESWSUCC             bigint,
  LTESWATT              bigint,
  SRQATT                bigint,
  SRQSUCC               bigint,
  TAUATT                bigint,
  TAUSUCC               bigint,
  RRCREBUILD            bigint,
  RRCSUCC               bigint,
  RRCREQ                bigint,
  IMSIREGATT            bigint,
  IMSIREGSUCC           bigint,
  WIRELESSDROP          bigint,
  WIRELESS              bigint,
  EABDROP               bigint,
  EAB                   bigint,
  EABS1SWX              bigint,
  EABS1SWY              bigint,
  S1TOX2SWX             bigint,
  S1TOX2SWY             bigint,
  ENBX2SWX              bigint,
  ENBX2SWY              bigint,
  UUENBSWX              bigint,
  UUENBSWY              bigint,
  UUENBINX              bigint,
  UUENBINY              bigint,
  SWX                   bigint,
  SWY                   bigint,
  ATTACHX               bigint,
  ATTACHY               bigint,
  voltesucc             bigint,
  srvccsuccS1           bigint
  )
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists volte_gt_user_ana_baseday;
CREATE TABLE volte_gt_user_ana_baseday(
   IMSI                   string,
  IMEI                   string,
  MSISDN                 string,
  CELLID                bigint,
  TTIME                  string,
  RAILLINE               string,
  DIR_STATE             bigint,
  VOLTEMCSUCC           bigint,
  VOLTEMCATT            bigint,
  VOLTEVDSUCC           bigint,
  VOLTEVDATT            bigint,
  VOLTETIME             bigint,
  VOLTEMCTIME           bigint,
  voltemctimey        bigint,
  VOLTEVDTIME           bigint,
  voltevdtimey        bigint,
  VOLTEMCHANDOVER       bigint,
  VOLTEANSWER           bigint,
  VOLTEVDHANDOVER       bigint,
  VOLTEVDANSWER         bigint,
  SRVCCSUCC             bigint,
  SRVCCATT              bigint,
  SRVCCTIME             bigint,
  LTESWSUCC             bigint,
  LTESWATT              bigint,
  SRQATT                bigint,
  SRQSUCC               bigint,
  TAUATT                bigint,
  TAUSUCC               bigint,
  RRCREBUILD            bigint,
  RRCSUCC               bigint,
  RRCREQ                bigint,
  IMSIREGATT            bigint,
  IMSIREGSUCC           bigint,
  WIRELESSDROP          bigint,
  WIRELESS              bigint,
  EABDROP               bigint,
  EAB                   bigint,
  EABS1SWX              bigint,
  EABS1SWY              bigint,
  S1TOX2SWX             bigint,
  S1TOX2SWY             bigint,
  ENBX2SWX              bigint,
  ENBX2SWY              bigint,
  UUENBSWX              bigint,
  UUENBSWY              bigint,
  UUENBINX              bigint,
  UUENBINY              bigint,
  SWX                   bigint,
  SWY                   bigint,
  ATTACHX               bigint,
  ATTACHY               bigint,
  voltesucc             bigint,
  srvccsuccS1           bigint)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_cell_ana_base60;
CREATE TABLE mr_gt_cell_ana_base60(
  cellid int,
  ttime string,
  dir_state int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_cell_ana_baseday;
CREATE TABLE mr_gt_cell_ana_baseday(
  cellid int,
  ttime string,
  dir_state int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_user_ana_base60;
CREATE TABLE mr_gt_user_ana_base60(
  imsi string,
  imei string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  elong int,
  elat int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table if exists mr_gt_user_ana_baseday;
CREATE TABLE mr_gt_user_ana_baseday(
  imsi string,
  imei string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  elong int,
  elat int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

--山西现场KPI
drop table if exists sh_tb_xdr_ifc_dns;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_dns(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid string,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum int,
  tcplinkstatus int,
  sessionflag int,
  reqdns string,
  resultip string,
  dnsrecode bigint,
  dnsattnum bigint,
  dnsrenum bigint,
  licensedconnum bigint,
  additionalconnum bigint,
  parentxdrid string)
 PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/dns';

--山西现场KPI
drop table if exists sh_tb_xdr_ifc_email;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_email(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  emailtranstype bigint,
  restatuscode bigint,
  username string,
  sender string,
  email string,
  smtpaddr string,
  recipacc string,
  messheadinfor string,
  accesstype int,
  parentxdrid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/email';

--山西现场KPI
drop table if exists sh_tb_xdr_ifc_http;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_http(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior int,
  wtpinterrupttype int,
  wtpinterruptcause int,
  title string,
  keyword string,
  busconductlogo int,
  buscompletionflag int,
  busrede int,
  browsingtool int,
  portalapp int,
  parentxdrid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/http';

--山西现场kpi
drop table if exists sh_tb_xdr_ifc_mms;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_mms(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  transtype int,
  successflag int,
  httporwap1x int,
  httpwapcode bigint,
  mmserspstatus bigint,
  mmssendaddr string,
  mmsmsgid string,
  mmstransactionid string,
  mmsretriveaddr string,
  mmsretriveaddrnum bigint,
  mmsccbccaddr string,
  mmsccbccaddrnum bigint,
  mmssubject string,
  mmsdatasize bigint,
  mmscipaddr string,
  host string,
  uri string,
  xonlinehost string,
  parentxdrid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/mms';

--山西现场KPI
drop table if exists t_pub_option_failcause;
CREATE EXTERNAL TABLE t_pub_option_failcause(
  option_definition_id bigint,
  option_code string,
  option_desc string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/t_pub_option_failcause';

--山西现场
drop table if exists tb_xdr_ifc_s1mme_new;
CREATE external TABLE tb_xdr_ifc_s1mme_new(
  length int,
 city string,
 interface int,
 xdrid string,
 rat int,
 imsi string,
 imei string,
 msisdn string,
 proceduretype int,
 procedurestarttime bigint,
 procedureendtime bigint,
 procedurestatus int,
 requestcause int,
 failurecause int,
 keyword1 int,
 keyword2 int,
 keyword3 int,
 keyword4 int,
 mmeues1apid int,
 oldmmegroupid int,
 oldmmecode int,
 oldmtmsi int,
 mmegroupid int,
 mmecode int,
 mtmsi int,
 tmsi int,
 useripv4 string,
 useripv6 string,
 mmeipadd string,
 enbipadd string,
 mmeport int,
 enbport int,
 tac int,
 cellid int,
 othertac int,
 othereci int,
 apn string,
 epsbearernumber int,
 bearer0id int,
 bearer0type int,
 bearer0qci int,
 bearer0status int,
 bearer0requestcause int,
 bearer0failurecause int,
 bearer0enbgtpteid int,
 bearer0sgwgtpteid int,
 bearer1id int,
 bearer1type int,
 bearer1qci int,
 bearer1status int,
 bearer1requestcause int,
 bearer1failurecause int,
 bearer1enbgtpteid int,
 bearer1sgwgtpteid int,
 bearer2id int,
 bearer2type int,
 bearer2qci int,
 bearer2status int,
 bearer2requestcause int,
 bearer2failurecause int,
 bearer2enbgtpteid int,
 bearer2sgwgtpteid int,
 bearer3id int,
 bearer3type int,
 bearer3qci int,
 bearer3status int,
 bearer3requestcause int,
 bearer3failurecause int,
 bearer3enbgtpteid int,
 bearer3sgwgtpteid int,
 bearer4id int,
 bearer4type int,
 bearer4qci int,
 bearer4status int,
 bearer4requestcause int,
 bearer4failurecause int,
 bearer4enbgtpteid int,
 bearer4sgwgtpteid int,
 bearer5id int,
 bearer5type int,
 bearer5qci int,
 bearer5status int,
 bearer5requestcause int,
 bearer5failurecause int,
 bearer5enbgtpteid int,
 bearer5sgwgtpteid int,
 BEARER6ID    int,
BEARER6TYPE    int,
BEARER6QCI    int,
BEARER6STATUS    int,
BEARER6REQUESTCAUSE    int,
BEARER6FAILURECAUSE    int,
BEARER6ENBGTPTEID    int,
BEARER6SGWGTPTEID    int,
BEARER7ID    int,
BEARER7TYPE    int,
BEARER7QCI    int,
BEARER7STATUS    int,
BEARER7REQUESTCAUSE    int,
BEARER7FAILURECAUSE    int,
BEARER7ENBGTPTEID    int,
BEARER7SGWGTPTEID    int,
BEARER8ID    int,
BEARER8TYPE    int,
BEARER8QCI    int,
BEARER8STATUS    int,
BEARER8REQUESTCAUSE    int,
BEARER8FAILURECAUSE    int,
BEARER8ENBGTPTEID    int,
BEARER8SGWGTPTEID    int,
BEARER9ID    int,
BEARER9TYPE    int,
BEARER9QCI    int,
BEARER9STATUS    int,
BEARER9REQUESTCAUSE    int,
BEARER9FAILURECAUSE    int,
BEARER9ENBGTPTEID    int,
BEARER9SGWGTPTEID    int,
BEARER10ID    int,
BEARER10TYPE    int,
BEARER10QCI    int,
BEARER10STATUS    int,
BEARER10REQUESTCAUSE    int,
BEARER10FAILURECAUSE    int,
BEARER10ENBGTPTEID    int,
BEARER10SGWGTPTEID    int,
BEARER11ID    int,
BEARER11TYPE    int,
BEARER11QCI    int,
BEARER11STATUS    int,
BEARER11REQUESTCAUSE    int,
BEARER11FAILURECAUSE    int,
BEARER11ENBGTPTEID    int,
BEARER11SGWGTPTEID    int,
BEARER12ID    int,
BEARER12TYPE    int,
BEARER12QCI    int,
BEARER12STATUS    int,
BEARER12REQUESTCAUSE    int,
BEARER12FAILURECAUSE    int,
BEARER12ENBGTPTEID    int,
BEARER12SGWGTPTEID    int,
BEARER13ID    int,
BEARER13TYPE    int,
BEARER13QCI    int,
BEARER13STATUS    int,
BEARER13REQUESTCAUSE    int,
BEARER13FAILURECAUSE    int,
BEARER13ENBGTPTEID    int,
BEARER13SGWGTPTEID    int,
BEARER14ID    int,
BEARER14TYPE    int,
BEARER14QCI    int,
BEARER14STATUS    int,
BEARER14REQUESTCAUSE    int,
BEARER14FAILURECAUSE    int,
BEARER14ENBGTPTEID    int,
BEARER14SGWGTPTEID    int,
BEARER15ID    int,
BEARER15TYPE    int,
BEARER15QCI    int,
BEARER15STATUS    int,
BEARER15REQUESTCAUSE    int,
BEARER15FAILURECAUSE    int,
BEARER15ENBGTPTEID    int,
BEARER15SGWGTPTEID    int,
 rangetime string,
 gridid int,
 slong string,
 slat string,
 dlong string,
 dlat string,
 distance string,
 espeed string,
 elong string,
 elat string,
 falurecause string,
 flag int,
 beforeflag int,
 eupordown int,
 railline string,
 echk4gtype int,
 echk4g23type int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
location
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_s1mme';

drop table lte_mro_source_new;
CREATE EXTERNAL TABLE lte_mro_source_new(
  objectid string,
  vid int,
  fileformatversion string,
  starttime string,
  endtime string,
  period int,
  enbid int,
  userlabel string,
  mrname string,
  cellid int,
  earfcn int,
  subframenbr int,
  prbnbr int,
  mmeues1apid int,
  mmegroupid int,
  mmecode int,
  meatime string,
  eventtype string,
  gridcenterlongitude string,
  gridcenterlatitude string,
  kpi1 int,
  kpi2 int,
  kpi3 int,
  kpi4 int,
  kpi5 int,
  kpi6 int,
  kpi7 int,
  kpi8 int,
  kpi9 int,
  kpi10 int,
  kpi11 int,
  kpi12 int,
  kpi13 int,
  kpi14 int,
  kpi15 int,
  kpi16 int,
  kpi17 int,
  kpi18 int,
  kpi19 int,
  kpi20 int,
  kpi21 int,
  kpi22 int,
  kpi23 int,
  kpi24 int,
  kpi25 int,
  kpi26 int,
  kpi27 int,
  kpi28 int,
  kpi29 int,
  kpi30 int,
  kpi31 int,
  kpi32 int,
  kpi33 int,
  kpi34 int,
  kpi35 int,
  kpi36 int,
  kpi37 int,
  kpi38 int,
  kpi39 int,
  kpi40 int,
  kpi41 int,
  kpi42 int,
  kpi43 int,
  kpi44 int,
  kpi45 int,
  kpi46 int,
  kpi47 int,
  kpi48 int,
  kpi49 int,
  kpi50 int,
  kpi51 int,
  kpi52 int,
  kpi53 int,
  kpi54 int,
  kpi55 int,
  kpi56 int,
  kpi57 int,
  kpi58 int,
  kpi59 int,
  kpi60 int,
  kpi61 int,
  kpi62 int,
  kpi63 int,
  kpi64 int,
  kpi65 int,
  kpi66 int,
  kpi67 int,
  kpi68 int,
  kpi69 int,
  kpi70 int,
  kpi71 int,
  length int,
  city string,
  xdrtype int,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  mrtype int,
  neighborcellnumber int,
  gsmneighborcellnumber int,
  tdsneighborcellnumber int,
  v_enb int,
  mrtime bigint,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/lte_mro_source';

--山西现场
drop table if exists tb_xdr_ifc_sgs;
CREATE EXTERNAL TABLE tb_xdr_ifc_sgs(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  sgscause bigint,
  rejectcause bigint,
  cpcause bigint,
  rpcause bigint,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  mscserveripadd string,
  mmeport bigint,
  mscserverport bigint,
  serviceindicator bigint,
  mmename string,
  tmsi bigint,
  newlac bigint,
  oldlac bigint,
  tac bigint,
  cellid bigint,
  callingid string,
  vlrnamelength bigint,
  vlrname string,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_SGS';

--山西现场
drop table if exists tb_xdr_ifc_sv;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport bigint,
  destneip string,
  destneport bigint,
  roamdirection bigint,
  homemcc bigint,
  homemnc bigint,
  mcc bigint,
  mnc bigint,
  targetlac bigint,
  sourcetac bigint,
  sourceeci bigint,
  svflags bigint,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid bigint,
  dlcmmeteid bigint,
  stnsr string,
  targetrncid bigint,
  targetcellid bigint,
  arp bigint,
  requestresult bigint,
  result bigint,
  svcause bigint,
  postfailurecause bigint,
  respdelay bigint,
  svdelay bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_SV';

--山西现场
drop table if exists tb_xdr_ifc_uu_new;
CREATE external TABLE tb_xdr_ifc_uu_new(
  length bigint,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  keyword1 int,
  keyword2 int,
  procedurestatus int,
  plmnid string,
  enbid int,
  cellid int,
  crnti int,
  targetenbid int,
  targetcellid int,
  targetcrnti int,
  mmeues1apid int,
  mmegroupid int,
  mmecode int,
  mtmsi int,
  csfbindication int,
  epsbearernumber int,
  bearer0id int,
  bearer0status int,
  bearer1id int,
  bearer1status int,
  bearer2id int,
  bearer2status int,
  bearer3id int,
  bearer3status int,
  bearer4id int,
  bearer4status int,
  bearer5id int,
  bearer5status int,
  rangetime string,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
location
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_uu';

--山西现场
drop table if exists tb_xdr_ifc_x2_new;
CREATE external TABLE tb_xdr_ifc_x2_new(
length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus int,
  cellid int,
  targetcellid int,
  enbid int,
  targetenbid int,
  mmeues1apid int,
  mmegroupid int,
  mmecode int,
  requestcause int,
  failurecause int,
  epsbearernumber int,
  bearer0id int,
  bearer0status int,
  bearer1id int,
  bearer1status int,
  bearer2id int,
  bearer2status int,
  bearer3id int,
  bearer3status int,
  bearer4id int,
  bearer4status int,
  bearer5id int,
  bearer5status int,
  rangetime string,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
location
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_x2';

--山西现场
drop table if exists grid_rru;
CREATE TABLE grid_rru(
  gridid int,
  rruid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_gmmwmgmimjisc_new;
CREATE external TABLE tb_xdr_ifc_gmmwmgmimjisc_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  servicetype int,
  procedurestatus int,
  callingnumber string,
  callednumber string,
  callingpartyuri string,
  requesturi string,
  userip string,
  callid string,
  icid string,
  sourceneip string,
  sourceneport int,
  destneip string,
  destneport int,
  callside int,
  sourceaccesstype int,
  sourceeci int,
  sourcetac int,
  sourceimsi string,
  sourceimei string,
  destaccesstype int,
  desteci int,
  desttac int,
  destimsi string,
  destimei string,
  authtype int,
  expirestimereq int,
  expirestimersp int,
  callingsdpipaddr string,
  callingaudiosdpport int,
  callingvideosdpport int,
  calledsdpipaddr string,
  calledaudiosdpport int,
  calledvideoport int,
  audiocodec int,
  videocodec int,
  redirectingpartyaddress string,
  originalpartyaddress string,
  redirectreason int,
  responsecode int,
  finishwarningcode int,
  finishreasonprotocol int,
  finishreasoncause int,
  firfailtime int,
  firstfailneip string,
  firstFailTransaction string,
  alertingtime int,
  answertime int,
  releasetime int,
  callduration int,
  authreqtime int,
  authrsptime int,
  stnsr string,
  atcfmgmt string,
  atusti string,
  cmsisdn string,
  ssi string,
  rangetime string,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
location
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_mw';

--山西现场
drop table if exists tb_xdr_ifc_gxrx_new;
CREATE EXTERNAL TABLE tb_xdr_ifc_gxrx_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  icid string,
  originrealm string,
  destinationrealm string,
  originhost string,
  destinationhost string,
  sgsnsgwsigip string,
  afappid string,
  ccrequesttype int,
  rxrequesttype int,
  mediatype int,
  abortcause int,
  resultcode int,
  experimentalresultcode int,
  sessionreleasecause int,
  rangetime string,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/gxrx';

--山西现场
drop table if exists tb_xdr_ifc_s1u_common_new;
CREATE TABLE tb_xdr_ifc_s1u_common_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_dns_new;
CREATE TABLE tb_xdr_ifc_s1u_dns_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  reqdns string,
  resultip string,
  dnsrecode bigint,
  dnsattnum bigint,
  dnsrenum bigint,
  licensedconnum bigint,
  additionalconnum bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_email_new;
CREATE TABLE tb_xdr_ifc_s1u_email_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  emailtranstype bigint,
  restatuscode bigint,
  username string,
  sender string,
  email string,
  smtpaddr string,
  recipacc string,
  messheadinfor string,
  accesstype bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_ftp_new;
CREATE TABLE tb_xdr_ifc_s1u_ftp_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  ftpstatus bigint,
  loginuser string,
  currentdirectory string,
  filetransfermode bigint,
  transdirectflag bigint,
  filename string,
  ftplocdataport bigint,
  ftpremdataport bigint,
  totalfilesize bigint,
  ftprede bigint,
  transdura bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_http_new;
CREATE external TABLE tb_xdr_ifc_s1u_http_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior bigint,
  wtpinterrupttype bigint,
  wtpinterruptcause bigint,
  title string,
  keyword string,
  busconductlogo bigint,
  buscompletionflag bigint,
  busrede bigint,
  browsingtool bigint,
  portalapp bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
location
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_s1u_http_new';
--山西现场
drop table if exists tb_xdr_ifc_s1u_mms_new;
CREATE external TABLE tb_xdr_ifc_s1u_mms_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  transtype bigint,
  successflag bigint,
  httporwap1x bigint,
  httpwapcode bigint,
  mmserspstatus bigint,
  mmssendaddr string,
  mmsmsgid string,
  mmstransactionid string,
  mmsretriveaddr string,
  mmsretriveaddrnum bigint,
  mmsccbccaddr string,
  mmsccbccaddrnum bigint,
  mmssubject string,
  mmsdatasize bigint,
  mmscipaddr string,
  host string,
  uri string,
  xonlinehost string,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
location
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_s1u_mms';

--山西现场
drop table if exists tb_xdr_ifc_s1u_p2p_new;
CREATE TABLE tb_xdr_ifc_s1u_p2p_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid string,
  tac string,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  filesize bigint,
  p2psign string,
  tracker string,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_rtcomm_new;
CREATE TABLE tb_xdr_ifc_s1u_rtcomm_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid string,
  tac string,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  rtcomm string,
  appversion string,
  clversion string,
  opertype bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_rtsp_new;
CREATE external TABLE tb_xdr_ifc_s1u_rtsp_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid string,
  tac string,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  rtspurl string,
  useragent string,
  rtpip string,
  rtpstartclport bigint,
  rtpendclport bigint,
  rtpstartserport bigint,
  rtpendserport bigint,
  rtspvidstream bigint,
  rtspaudstream bigint,
  rtsprede bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
location
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/tb_xdr_ifc_s1u_rtsp_new';

--山西现场
drop table if exists tb_xdr_ifc_s1u_voip_new;
CREATE TABLE tb_xdr_ifc_s1u_voip_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  calldirection bigint,
  callernum string,
  callednum string,
  calltype bigint,
  voipstreamsnum bigint,
  reasonhook bigint,
  signprotype bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_sgs_new;
CREATE EXTERNAL TABLE tb_xdr_ifc_sgs_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus int,
  sgscause int,
  rejectcause int,
  cpcause int,
  rpcause int,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  mscserveripadd string,
  mmeport int,
  mscserverport int,
  serviceindicator int,
  mmename string,
  tmsi int,
  newlac int,
  oldlac int,
  tac int,
  cellid int,
  callingid string,
  vlrnamelength int,
  vlrname string,
  rangetime string,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/sgs';

--山西现场
drop table if exists tb_xdr_ifc_sv_new;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport int,
  destneip string,
  destneport int,
  roamdirection int,
  homemcc int,
  homemnc int,
  mcc int,
  mnc int,
  targetlac int,
  sourcetac int,
  sourceeci int,
  svflags int,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid int,
  dlcmmeteid int,
  stnsr string,
  targetrncid int,
  targetcellid int,
  arp int,
  requestresult int,
  result int,
  svcause int,
  postfailurecause int,
  respdelay int,
  svdelay int,
  rangetime string,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  railline string,
  echksvtype int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/sv_xdr';

--山西现场
drop table if exists tb_xdr_ifc_uu_new_sk;
CREATE EXTERNAL TABLE tb_xdr_ifc_uu_new_sk(
  length bigint,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  keyword1 int,
  keyword2 int,
  procedurestatus int,
  plmnid string,
  enbid int,
  cellid int,
  crnti int,
  targetenbid int,
  targetcellid int,
  targetcrnti int,
  mmeues1apid int,
  mmegroupid int,
  mmecode int,
  mtmsi int,
  csfbindication int,
  epsbearernumber int,
  bearer0id int,
  bearer0status int,
  bearer1id int,
  bearer1status int,
  bearer2id int,
  bearer2status int,
  bearer3id int,
  bearer3status int,
  bearer4id int,
  bearer4status int,
  bearer5id int,
  bearer5status int,
  rangetime string,
  etype int,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_UU';

drop table if exists cell_mr;
CREATE TABLE cell_mr(
  objectid string,
  vid bigint,
  fileformatversion string,
  starttime bigint,
  endtime bigint,
  period bigint,
  enbid bigint,
  userlabel string,
  mrname string,
  cellid bigint,
  earfcn bigint,
  subframenbr bigint,
  prbnbr bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  meatime string,
  eventtype string,
  gridcenterlongitude string,
  gridcenterlatitude string,
  kpi1 bigint,
  kpi2 bigint,
  kpi3 bigint,
  kpi4 bigint,
  kpi5 bigint,
  kpi6 bigint,
  kpi7 bigint,
  kpi8 bigint,
  kpi9 bigint,
  kpi10 bigint,
  kpi11 bigint,
  kpi12 bigint,
  kpi13 bigint,
  kpi14 bigint,
  kpi15 bigint,
  kpi16 bigint,
  kpi17 bigint,
  kpi18 bigint,
  kpi19 bigint,
  kpi20 bigint,
  kpi21 bigint,
  kpi22 bigint,
  kpi23 bigint,
  kpi24 bigint,
  kpi25 bigint,
  kpi26 bigint,
  kpi27 bigint,
  kpi28 bigint,
  kpi29 bigint,
  kpi30 bigint,
  kpi31 bigint,
  kpi32 bigint,
  kpi33 bigint,
  kpi34 bigint,
  kpi35 bigint,
  kpi36 bigint,
  kpi37 bigint,
  kpi38 bigint,
  kpi39 bigint,
  kpi40 bigint,
  kpi41 bigint,
  kpi42 bigint,
  kpi43 bigint,
  kpi44 bigint,
  kpi45 bigint,
  kpi46 bigint,
  kpi47 bigint,
  kpi48 bigint,
  kpi49 bigint,
  kpi50 bigint,
  kpi51 bigint,
  kpi52 bigint,
  kpi53 bigint,
  kpi54 bigint,
  kpi55 bigint,
  kpi56 bigint,
  kpi57 bigint,
  kpi58 bigint,
  kpi59 bigint,
  kpi60 bigint,
  kpi61 bigint,
  kpi62 bigint,
  kpi63 bigint,
  kpi64 bigint,
  kpi65 bigint,
  kpi66 bigint,
  kpi67 bigint,
  kpi68 bigint,
  kpi69 bigint,
  kpi70 bigint,
  kpi71 bigint,
  length bigint,
  city string,
  xdrtype bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  mrtype bigint,
  neighborcellnumber bigint,
  gsmneighborcellnumber bigint,
  tdsneighborcellnumber bigint,
  v_enb bigint,
  mrtime bigint)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';



--高铁用户识别表
drop table if exists volte_gtuser_data;
create EXTERNAL table if not exists volte_gtuser_data(
imsi string,
cellid string,
ttime string
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
location '/${DB_PATH}/volte_gtuser_data' ;

--20170606山西现场
drop table  kpi_mid_cell_day;
CREATE TABLE kpi_mid_cell_day(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table  kpi_mid_cell_hour;
CREATE TABLE kpi_mid_cell_hour(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';


drop  table kpi_mid_imsi_cell_day;
 CREATE TABLE kpi_mid_imsi_cell_day(
  ttime string,
  imsi string,
  msisdn string,
  cellid int,
  railline string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table kpi_mid_imsi_cell_hour;
CREATE TABLE kpi_mid_imsi_cell_hour(
  ttime string,
  imsi string,
  msisdn string,
  cellid int,
  railline string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_cell_day;
  CREATE TABLE mro_kpi_mid_cell_day(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_cell_grid_day;
 CREATE TABLE mro_kpi_mid_cell_grid_day(
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';


drop table mro_kpi_mid_cell_grid_hour;
  CREATE TABLE mro_kpi_mid_cell_grid_hour(
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_cell_hour;
  CREATE TABLE mro_kpi_mid_cell_hour(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_imsi_cell_grid_day;
  CREATE TABLE mro_kpi_mid_imsi_cell_grid_day(
  imsi string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_imsi_cell_grid_hour;
  CREATE TABLE mro_kpi_mid_imsi_cell_grid_hour(
  imsi string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

DROP TABLE IF EXISTS TB_XDR_IFC_UU ;
CREATE  TABLE  IF NOT EXISTS  TB_XDR_IFC_UU (
      LENGTH                       BIGINT,
      CITY                         STRING,
      INTERFACE                     INT,
      XDRID                         STRING,
      RAT                           BIGINT,
      IMSI                          STRING,
      IMEI                          STRING,
      MSISDN                        STRING,
      PROCEDURETYPE                 INT,
      PROCEDURESTARTTIME            BIGINT, -- STRING,
      PROCEDUREENDTIME              BIGINT, -- STRING,
      KEYWORD1                      INT,
      KEYWORD2                      INT,
      PROCEDURESTATUS               INT,
      PLMNID                        STRING,
      ENBID                         BIGINT,
      CELLID                        BIGINT,
      CRNTI                         BIGINT,
      TARGETENBID                   BIGINT,
      TARGETCELLID                  BIGINT,
      TARGETCRNTI                   BIGINT,
      MMEUES1APID                   BIGINT,
      MMEGROUPID                    BIGINT,
      MMECODE                       BIGINT,
      MTMSI                         BIGINT,
      CSFBINDICATION                BIGINT,
      REDIRECTEDNETWORK             BIGINT,
      EPSBEARERNUMBER               INT,
      BEARER0ID                     BIGINT,
      BEARER0STATUS                 BIGINT,
      BEARER1ID                     BIGINT,
      BEARER1STATUS                 BIGINT,
      BEARER2ID                     BIGINT,
      BEARER2STATUS                 BIGINT,
      BEARER3ID                     BIGINT,
      BEARER3STATUS                 BIGINT,
      BEARER4ID                     BIGINT,
      BEARER4STATUS                 BIGINT,
      BEARER5ID                     BIGINT,
      BEARER5STATUS                 BIGINT,
      BEARER6ID                     BIGINT,
      BEARER6STATUS                 BIGINT,
      BEARER7ID                     BIGINT,
      BEARER7STATUS                 BIGINT,
      BEARER8ID                     BIGINT,
      BEARER8STATUS                 BIGINT,
      BEARER9ID                     BIGINT,
      BEARER9STATUS                 BIGINT,
      BEARER10ID                     STRING,
      BEARER10STATUS                 STRING,
      BEARER11ID                     STRING,
      BEARER11STATUS                 STRING,
      BEARER12ID                     STRING,
      BEARER12STATUS                 STRING,
      BEARER13ID                     STRING,
      BEARER13STATUS                 STRING,
      BEARER14ID                     STRING,
      BEARER14STATUS                 STRING,
      BEARER15ID                     STRING,
      BEARER15STATUS                 STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ',';


--质差小区表
drop table zc_city_data;
create table zc_city_data(
    ttime string,
    city  string,
    cellid int,
    businessdelay double,
    pageDownKps double,
    etype int
)PARTITIONED by (
dt string,
h string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ',';



CREATE DATABASE IF NOT EXISTS ${BaseDB};
use ${BaseDB} ;

drop table if exists tb_xdr_ifc_x2;
  CREATE EXTERNAL TABLE tb_xdr_ifc_x2(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  cellid bigint,
  targetcellid bigint,
  enbid bigint,
  targetenbid bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  requestcause bigint,
  failurecause bigint,
  epsbearernumber bigint,
  bearer0id bigint,
  bearer0status bigint,
  bearer1id bigint,
  bearer1status bigint,
  bearer2id bigint,
  bearer2status bigint,
  bearer3id bigint,
  bearer3status bigint,
  bearer4id bigint,
  bearer4status bigint,
  bearer5id bigint,
  bearer5status bigint,
  bearer6id bigint,
  bearer6status bigint,
  bearer7id bigint,
  bearer7status bigint,
  bearer8id bigint,
  bearer8status bigint,
  bearer9id bigint,
  bearer9status bigint,
  bearer10id bigint,
  bearer10status bigint,
  bearer11id bigint,
  bearer11status bigint,
  bearer12id bigint,
  bearer12status bigint,
  bearer13id bigint,
  bearer13status bigint,
  bearer14id bigint,
  bearer14status bigint,
  bearer15id bigint,
  bearer15status bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_X2' ;

drop table if exists tb_xdr_ifc_http;
  CREATE EXTERNAL TABLE tb_xdr_ifc_http(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior int,
  wtpinterrupttype int,
  wtpinterruptcause int,
  title string,
  keyword string,
  busconductlogo int,
  buscompletionflag int,
  busrede int,
  browsingtool int,
  portalapp int,
  parentxdrid string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY '|'
LOCATION
  'hdfs://dtcluster/${BasePath}/s1u_http_orgn' ;

DROP TABLE   IF EXISTS LTE_MRO_SOURCE;
create EXTERNAL table   IF NOT EXISTS LTE_MRO_SOURCE
(
       objectID       STRING ,
       VID             BIGINT  ,
       fileFormatVersion STRING ,
       startTime       STRING  ,
       endTime         STRING ,
       period          BIGINT ,
       enbID           BIGINT,
       userLabel      STRING ,
       mrName         STRING ,
       cellID          BIGINT ,
       Earfcn          BIGINT ,
       SubFrameNbr     BIGINT ,
       PRBNbr          BIGINT ,
       MmeUeS1apId     BIGINT ,
       MmeGroupId      BIGINT ,
       MmeCode         BIGINT ,
       meaTime         STRING ,
       EventType      STRING ,
       gridcenterLongitude   STRING,
       gridcenterLatitude    STRING,
       kpi1            BIGINT ,
       kpi2            BIGINT ,
       kpi3            BIGINT ,
       kpi4            BIGINT ,
       kpi5            BIGINT ,
       kpi6            BIGINT ,
       kpi7            BIGINT ,
       kpi8            BIGINT ,
       kpi9            BIGINT ,
       kpi10           BIGINT ,
       kpi11           BIGINT ,
       kpi12           BIGINT ,
       kpi13           BIGINT ,
       kpi14           BIGINT ,
       kpi15           BIGINT ,
       kpi16           BIGINT ,
       kpi17           BIGINT ,
       kpi18           BIGINT ,
       kpi19           BIGINT ,
       kpi20           BIGINT ,
       kpi21           BIGINT ,
       kpi22           BIGINT ,
       kpi23           BIGINT ,
       kpi24           BIGINT ,
       kpi25           BIGINT ,
       kpi26           BIGINT ,
       kpi27           BIGINT ,
       kpi28           BIGINT ,
       kpi29           BIGINT ,
       kpi30           BIGINT ,
       kpi31           BIGINT ,
       kpi32           BIGINT ,
       kpi33           BIGINT ,
       kpi34           BIGINT ,
       kpi35           BIGINT ,
       kpi36           BIGINT ,
       kpi37           BIGINT ,
       kpi38           BIGINT ,
       kpi39           BIGINT ,
       kpi40           BIGINT ,
       kpi41           BIGINT ,
       kpi42           BIGINT ,
       kpi43           BIGINT ,
       kpi44           BIGINT ,
       kpi45           BIGINT ,
       kpi46           BIGINT ,
       kpi47           BIGINT ,
       kpi48           BIGINT ,
       kpi49           BIGINT ,
       kpi50           BIGINT ,
       kpi51           BIGINT ,
       kpi52           BIGINT ,
       kpi53           BIGINT ,
       kpi54           BIGINT ,
       kpi55           BIGINT ,
       kpi56           BIGINT ,
       kpi57           BIGINT ,
       kpi58           BIGINT ,
       kpi59           BIGINT ,
       kpi60           BIGINT ,
       kpi61           BIGINT ,
       kpi62           BIGINT ,
       kpi63           BIGINT ,
       kpi64           BIGINT ,
       kpi65           BIGINT ,
       kpi66           BIGINT ,
       kpi67           BIGINT ,
       kpi68           BIGINT ,
       kpi69           BIGINT ,
       kpi70           BIGINT ,
       kpi71           BIGINT ,
       length          BIGINT ,
       City            STRING ,
       XDRType         BIGINT ,
       Interface       BIGINT ,
       XDRID          STRING ,
       RAT             BIGINT ,
       IMSI           STRING ,
       IMEI           STRING ,
       MSISDN         STRING ,
       MRType          BIGINT ,
       NeighborCellNumber BIGINT ,
       gsmNeighborCellNumber   BIGINT ,
       tdsNeighborCellNumber   BIGINT ,
       v_enb BIGINT,
     mrtime   BIGINT
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/LTE_MRO_SOURCE';

drop table if exists tb_xdr_ifc_dns;
CREATE EXTERNAL TABLE tb_xdr_ifc_dns(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid string,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum int,
  tcplinkstatus int,
  sessionflag int,
  reqdns string,
  resultip string,
  dnsrecode bigint,
  dnsattnum bigint,
  dnsrenum bigint,
  licensedconnum bigint,
  additionalconnum bigint,
  parentxdrid string)
  PARTITIONED BY (
  dt string,
  h string
  )
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/tb_xdr_ifc_dns' ;

--山西现场
drop table if exists tb_xdr_ifc_sv;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport bigint,
  destneip string,
  destneport bigint,
  roamdirection bigint,
  homemcc bigint,
  homemnc bigint,
  mcc bigint,
  mnc bigint,
  targetlac bigint,
  sourcetac bigint,
  sourceeci bigint,
  svflags bigint,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid bigint,
  dlcmmeteid bigint,
  stnsr string,
  targetrncid bigint,
  targetcellid bigint,
  arp bigint,
  requestresult bigint,
  result bigint,
  svcause bigint,
  postfailurecause bigint,
  respdelay bigint,
  svdelay bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_SV';


DROP TABLE  IF EXISTS TB_XDR_IFC_GMMWMGMIMJISC;
CREATE EXTERNAL TABLE  IF NOT EXISTS TB_XDR_IFC_GMMWMGMIMJISC (
      LENGTH                        BIGINT,
      CITY                         STRING,
      INTERFACE                     BIGINT,
      XDRID                        STRING,
      RAT                           BIGINT,
      IMSI                         STRING,
      IMEI                         STRING,
      MSISDN                       STRING,
      PROCEDURETYPE                 BIGINT,
      PROCEDURESTARTTIME           BIGINT,
      PROCEDUREENDTIME             BIGINT,
      SERVICETYPE                   BIGINT,
      PROCEDURESTATUS               BIGINT,
      CALLINGNUMBER                STRING,
      CALLEDNUMBER                 STRING,
      CALLINGPARTYURI              STRING,
      REQUESTURI                   STRING,
      USERIP                       STRING,
      CALLID                       STRING,
      ICID                         STRING,
      SOURCENEIP                   STRING,
      SOURCENEPORT                  BIGINT,
      DESTNEIP                     STRING,
      DESTNEPORT                    BIGINT,
      CALLSIDE                      BIGINT,
      SOURCEACCESSTYPE              BIGINT,
      SOURCEECI                     BIGINT,
      SOURCETAC                     BIGINT,
      SOURCEIMSI                   STRING,
      SOURCEIMEI                   STRING,
      DESTACCESSTYPE                BIGINT,
      DESTECI                       BIGINT,
      DESTTAC                       BIGINT,
      DESTIMSI                     STRING,
      DESTIMEI                     STRING,
      AUTHTYPE                      BIGINT,
      EXPIRESTIMEREQ               BIGINT,
      EXPIRESTIMERSP               BIGINT,
      CALLINGSDPIPADDR             STRING,
      CALLINGAUDIOSDPPORT           BIGINT,
      CALLINGVIDEOSDPPORT           BIGINT,
      CALLEDSDPIPADDR              STRING,
      CALLEDAUDIOSDPPORT            BIGINT,
      CALLEDVIDEOPORT               BIGINT,
      AUDIOCODEC                    BIGINT,
      VIDEOCODEC                    BIGINT,
      REDIRECTINGPARTYADDRESS      STRING,
      ORIGINALPARTYADDRESS         STRING,
      REDIRECTREASON                BIGINT,
      RESPONSECODE                  BIGINT,
      FINISHWARNINGCODE             BIGINT,
      FINISHREASONPROTOCOL          BIGINT,
      FINISHREASONCAUSE             BIGINT,
      FIRFAILTIME                  BIGINT,
      FIRSTFAILNEIP                STRING,
      ALERTINGTIME                 BIGINT,
      ANSWERTIME                   BIGINT,
      RELEASETIME                  BIGINT,
      CALLDURATION                  BIGINT,
      AUTHREQTIME                  BIGINT,
      AUTHRSPTIME                  BIGINT,
      STNSR                        STRING,
      ATCFMGMT                     STRING,
      ATUSTI                       STRING,
      CMSISDN                      STRING,
      SSI                          STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/TB_XDR_IFC_GMMWMGMIMJISC';

DROP TABLE  IF EXISTS tb_xdr_ifc_mw;
CREATE EXTERNAL TABLE  IF NOT EXISTS tb_xdr_ifc_mw (
      LENGTH                        BIGINT,
      CITY                         STRING,
      INTERFACE                     BIGINT,
      XDRID                        STRING,
      RAT                           BIGINT,
      IMSI                         STRING,
      IMEI                         STRING,
      MSISDN                       STRING,
      PROCEDURETYPE                 BIGINT,
      PROCEDURESTARTTIME           BIGINT,
      PROCEDUREENDTIME             BIGINT,
      SERVICETYPE                   BIGINT,
      PROCEDURESTATUS               BIGINT,
      CALLINGNUMBER                STRING,
      CALLEDNUMBER                 STRING,
      CALLINGPARTYURI              STRING,
      REQUESTURI                   STRING,
      USERIP                       STRING,
      CALLID                       STRING,
      ICID                         STRING,
      SOURCENEIP                   STRING,
      SOURCENEPORT                  BIGINT,
      DESTNEIP                     STRING,
      DESTNEPORT                    BIGINT,
      CALLSIDE                      BIGINT,
      SOURCEACCESSTYPE              BIGINT,
      SOURCEECI                     BIGINT,
      SOURCETAC                     BIGINT,
      SOURCEIMSI                   STRING,
      SOURCEIMEI                   STRING,
      DESTACCESSTYPE                BIGINT,
      DESTECI                       BIGINT,
      DESTTAC                       BIGINT,
      DESTIMSI                     STRING,
      DESTIMEI                     STRING,
      AUTHTYPE                      BIGINT,
      EXPIRESTIMEREQ               BIGINT,
      EXPIRESTIMERSP               BIGINT,
      CALLINGSDPIPADDR             STRING,
      CALLINGAUDIOSDPPORT           BIGINT,
      CALLINGVIDEOSDPPORT           BIGINT,
      CALLEDSDPIPADDR              STRING,
      CALLEDAUDIOSDPPORT            BIGINT,
      CALLEDVIDEOPORT               BIGINT,
      AUDIOCODEC                    BIGINT,
      VIDEOCODEC                    BIGINT,
      REDIRECTINGPARTYADDRESS      STRING,
      ORIGINALPARTYADDRESS         STRING,
      REDIRECTREASON                BIGINT,
      RESPONSECODE                  BIGINT,
      FINISHWARNINGCODE             BIGINT,
      FINISHREASONPROTOCOL          BIGINT,
      FINISHREASONCAUSE             BIGINT,
      FIRFAILTIME                  BIGINT,
      FIRSTFAILNEIP                STRING,
      ALERTINGTIME                 BIGINT,
      ANSWERTIME                   BIGINT,
      RELEASETIME                  BIGINT,
      CALLDURATION                  BIGINT,
      AUTHREQTIME                  BIGINT,
      AUTHRSPTIME                  BIGINT,
      STNSR                        STRING,
      ATCFMGMT                     STRING,
      ATUSTI                       STRING,
      CMSISDN                      STRING,
      SSI                          STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/TB_XDR_IFC_GMMWMGMIMJISC';

drop table if exists tb_xdr_ifc_sv;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport bigint,
  destneip string,
  destneport bigint,
  roamdirection bigint,
  homemcc bigint,
  homemnc bigint,
  mcc bigint,
  mnc bigint,
  targetlac bigint,
  sourcetac bigint,
  sourceeci bigint,
  svflags bigint,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid bigint,
  dlcmmeteid bigint,
  stnsr string,
  targetrncid bigint,
  targetcellid bigint,
  arp bigint,
  requestresult bigint,
  result bigint,
  svcause bigint,
  postfailurecause bigint,
  respdelay bigint,
  svdelay bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_SV';

 drop table if exists tb_xdr_ifc_gxrx;
CREATE EXTERNAL TABLE tb_xdr_ifc_gxrx(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  icid string,
  originrealm string,
  destinationrealm string,
  originhost string,
  destinationhost string,
  sgsnsgwsigip string,
  afappid string,
  ccrequesttype bigint,
  rxrequesttype bigint,
  mediatype bigint,
  abortcause bigint,
  resultcode bigint,
  experimentalresultcode bigint,
  sessionreleasecause bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_GXRX' ;

drop table if exists tb_xdr_ifc_s1mme;
CREATE EXTERNAL TABLE tb_xdr_ifc_s1mme(
  length bigint,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  requestcause bigint,
  failurecause bigint,
  keyword1 bigint,
  keyword2 bigint,
  keyword3 bigint,
  keyword4 bigint,
  mmeues1apid bigint,
  oldmmegroupid bigint,
  oldmmecode bigint,
  oldmtmsi bigint,
  mmegroupid bigint,
  mmecode bigint,
  mtmsi bigint,
  tmsi bigint,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  enbipadd string,
  mmeport bigint,
  enbport bigint,
  tac bigint,
  cellid bigint,
  othertac bigint,
  othereci bigint,
  apn string,
  epsbearernumber bigint,
  bearer0id bigint,
  bearer0type bigint,
  bearer0qci bigint,
  bearer0status bigint,
  bearer0requestcause bigint,
  bearer0failurecause bigint,
  bearer0enbgtpteid bigint,
  bearer0sgwgtpteid bigint,
  bearer1id bigint,
  bearer1type bigint,
  bearer1qci bigint,
  bearer1status bigint,
  bearer1requestcause bigint,
  bearer1failurecause bigint,
  bearer1enbgtpteid bigint,
  bearer1sgwgtpteid bigint,
  bearer2id bigint,
  bearer2type bigint,
  bearer2qci bigint,
  bearer2status bigint,
  bearer2requestcause bigint,
  bearer2failurecause bigint,
  bearer2enbgtpteid bigint,
  bearer2sgwgtpteid bigint,
  bearer3id bigint,
  bearer3type bigint,
  bearer3qci bigint,
  bearer3status bigint,
  bearer3requestcause bigint,
  bearer3failurecause bigint,
  bearer3enbgtpteid bigint,
  bearer3sgwgtpteid bigint,
  bearer4id bigint,
  bearer4type bigint,
  bearer4qci bigint,
  bearer4status bigint,
  bearer4requestcause bigint,
  bearer4failurecause bigint,
  bearer4enbgtpteid bigint,
  bearer4sgwgtpteid bigint,
  bearer5id bigint,
  bearer5type bigint,
  bearer5qci bigint,
  bearer5status bigint,
  bearer5requestcause bigint,
  bearer5failurecause bigint,
  bearer5enbgtpteid bigint,
  bearer5sgwgtpteid bigint,
  bearer6id bigint,
  bearer6type bigint,
  bearer6qci bigint,
  bearer6status bigint,
  bearer6requestcause bigint,
  bearer6failurecause bigint,
  bearer6enbgtpteid bigint,
  bearer6sgwgtpteid bigint,
  bearer7id bigint,
  bearer7type bigint,
  bearer7qci bigint,
  bearer7status bigint,
  bearer7requestcause bigint,
  bearer7failurecause bigint,
  bearer7enbgtpteid bigint,
  bearer7sgwgtpteid bigint,
  bearer8id bigint,
  bearer8type bigint,
  bearer8qci bigint,
  bearer8status bigint,
  bearer8requestcause bigint,
  bearer8failurecause bigint,
  bearer8enbgtpteid bigint,
  bearer8sgwgtpteid bigint,
  bearer9id bigint,
  bearer9type bigint,
  bearer9qci bigint,
  bearer9status bigint,
  bearer9requestcause bigint,
  bearer9failurecause bigint,
  bearer9enbgtpteid bigint,
  bearer9sgwgtpteid bigint,
  bearer10id bigint,
  bearer10type bigint,
  bearer10qci bigint,
  bearer10status bigint,
  bearer10requestcause bigint,
  bearer10failurecause bigint,
  bearer10enbgtpteid bigint,
  bearer10sgwgtpteid bigint,
  bearer11id bigint,
  bearer11type bigint,
  bearer11qci bigint,
  bearer11status bigint,
  bearer11requestcause bigint,
  bearer11failurecause bigint,
  bearer11enbgtpteid bigint,
  bearer11sgwgtpteid bigint,
  bearer12id bigint,
  bearer12type bigint,
  bearer12qci bigint,
  bearer12status bigint,
  bearer12requestcause bigint,
  bearer12failurecause bigint,
  bearer12enbgtpteid bigint,
  bearer12sgwgtpteid bigint,
  bearer13id bigint,
  bearer13type bigint,
  bearer13qci bigint,
  bearer13status bigint,
  bearer13requestcause bigint,
  bearer13failurecause bigint,
  bearer13enbgtpteid bigint,
  bearer13sgwgtpteid bigint,
  bearer14id bigint,
  bearer14type bigint,
  bearer14qci bigint,
  bearer14status bigint,
  bearer14requestcause bigint,
  bearer14failurecause bigint,
  bearer14enbgtpteid bigint,
  bearer14sgwgtpteid bigint,
  bearer15id bigint,
  bearer15type bigint,
  bearer15qci bigint,
  bearer15status bigint,
  bearer15requestcause bigint,
  bearer15failurecause bigint,
  bearer15enbgtpteid bigint,
  bearer15sgwgtpteid bigint,
  rangetime string
  )
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_S1MME' ;

DROP TABLE IF EXISTS TB_XDR_IFC_UU ;
CREATE EXTERNAL TABLE  IF NOT EXISTS  TB_XDR_IFC_UU (
      LENGTH                       BIGINT,
      CITY                         STRING,
      INTERFACE                     INT,
      XDRID                         STRING,
      RAT                           BIGINT,
      IMSI                          STRING,
      IMEI                          STRING,
      MSISDN                        STRING,
      PROCEDURETYPE                 INT,
      PROCEDURESTARTTIME            BIGINT, -- STRING,
      PROCEDUREENDTIME              BIGINT, -- STRING,
      KEYWORD1                      INT,
      KEYWORD2                      INT,
      PROCEDURESTATUS               INT,
      PLMNID                        STRING,
      ENBID                         BIGINT,
      CELLID                        BIGINT,
      CRNTI                         BIGINT,
      TARGETENBID                   BIGINT,
      TARGETCELLID                  BIGINT,
      TARGETCRNTI                   BIGINT,
      MMEUES1APID                   BIGINT,
      MMEGROUPID                    BIGINT,
      MMECODE                       BIGINT,
      MTMSI                         BIGINT,
      CSFBINDICATION                BIGINT,
      REDIRECTEDNETWORK             BIGINT,
      EPSBEARERNUMBER               INT,
      BEARER0ID                     BIGINT,
      BEARER0STATUS                 BIGINT,
      BEARER1ID                     BIGINT,
      BEARER1STATUS                 BIGINT,
      BEARER2ID                     BIGINT,
      BEARER2STATUS                 BIGINT,
      BEARER3ID                     BIGINT,
      BEARER3STATUS                 BIGINT,
      BEARER4ID                     BIGINT,
      BEARER4STATUS                 BIGINT,
      BEARER5ID                     BIGINT,
      BEARER5STATUS                 BIGINT,
      BEARER6ID                     BIGINT,
      BEARER6STATUS                 BIGINT,
      BEARER7ID                     BIGINT,
      BEARER7STATUS                 BIGINT,
      BEARER8ID                     BIGINT,
      BEARER8STATUS                 BIGINT,
      BEARER9ID                     BIGINT,
      BEARER9STATUS                 BIGINT,
      BEARER10ID                     STRING,
      BEARER10STATUS                 STRING,
      BEARER11ID                     STRING,
      BEARER11STATUS                 STRING,
      BEARER12ID                     STRING,
      BEARER12STATUS                 STRING,
      BEARER13ID                     STRING,
      BEARER13STATUS                 STRING,
      BEARER14ID                     STRING,
      BEARER14STATUS                 STRING,
      BEARER15ID                     STRING,
      BEARER15STATUS                 STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/TB_XDR_IFC_UU';

--20170605新增
drop table VOLTE_GT_FREE_USER_DATA;
create EXTERNAL table VOLTE_GT_FREE_USER_DATA
(
  IMSI              string,
  CELLID             bigint,
  PROCEDURETYPE      int,
  PROCEDURESTATUS    int,
  RANGETIME          string,
  IMEI               string,
  MSISDN             string,
  PROCEDURESTARTTIME bigint,
  PROCEDUREENDTIME   bigint,
  DIR_STATE          int,
  SEQNUM             int,
  ISPUB              int
)
PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
location '/${BasePath}/FreeGtUser';

--20170605新增
drop table VOLTE_GT_BUSI_USER_DATA;
create EXTERNAL table VOLTE_GT_BUSI_USER_DATA
(
  IMSI               string,
  CELLID             bigint,
  TARGETCELLID       bigint,
  PROCEDURETYPE      bigint,
  PROCEDURESTATUS    bigint,
  RANGETIME          string,
  IMEI               string,
  MSISDN            string,
  PROCEDURESTARTTIME bigint,
  PROCEDUREENDTIME   bigint,
  ENBID              bigint,
  TARGETENBID        bigint,
  DIR_STATE          int,
  SEQNUM             int,
  ISPUB              int
)
PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
location '/${BasePath}/BusinessGtUser';

EOF
exit 0




