#!/bin/bash

DDLDB=$1
DB_PATH=$2
WAREHOUSE="user/hive/warehouse/$DDLDB.db"
#sh VolumeAnalyseInitTable.sh shanxi  'datang'

hive<<EOF

CREATE DATABASE IF NOT EXISTS ${DDLDB};
USE ${DDLDB};

--业务占比表
drop table business_type_detail;
create EXTERNAL table business_type_detail(
        TTIME              string,
        city               string,
        region             string,
        CELLID             int,
        app_type           string,
        app_sub_type       string,
        uldata             bigint,
        dldata             bigint,
        counts             bigint,
        timespan           bigint
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/business_type_detail';




--volte用户表
drop table if exists volte_user_data;
CREATE TABLE volte_user_data(
  ttime string,
  hours int,
  imsi string, 
  volte_start int, 
  volte_end int)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

--高铁用户识别表
drop table volte_gtuser_data;
create table volte_gtuser_data(
imsi string,
hours string,
ttime string
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;


--小区统计表（分钟级）
drop table if exists gt_pulse_detail;
create table gt_pulse_detail(
ttime string,
hours int,
minutes int,
cellid bigint,
imsi string,
imei string,
gtuser_flag int,
volteuser_flag int,
sub_pulse_mark int)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;



--子脉冲统计表(分钟级)
drop table if exists  gt_pulse_cell_min;
create table gt_pulse_cell_min(
ttime string,
hours int,
minutes int,
cellid bigint,
sub_pulse_mark int,
sub_pulse_type int,
users bigint,
gt_users bigint,
comm_users bigint,
volte_users bigint)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

--脉冲统计小时表
drop table if exists gt_pulse_cell_base60;
create table gt_pulse_cell_base60(
     ttime string,
     hours int,
     cellid bigint,
     pulse_mark bigint,
     pulse_type bigint,
     pulse_timelen bigint,
     first_pulse_mark bigint,
     sub_users_peak bigint,
     sub_gtusers_peak bigint,
     sub_volteusers_peak bigint,
     users bigint,
     gt_users bigint,
     volte_users bigint)
PARTITIONED BY ( 
  dt string,
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;


--脉冲明细小时表
drop table  if exists gt_pulse_detail_base60;
create table gt_pulse_detail_base60(
ttime string,
hours int,
cellid bigint,
imsi string,
pulse_mark bigint,
pulse_type bigint,
pulse_timelen bigint,
first_pulse_mark bigint,
gtuser_flag bigint,
volteuser_flag bigint)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

--城市高铁用户频段表
drop table gt_freq_baseday;
create table gt_freq_baseday(
     line_name  string,
     city string,
     ttime string,
     cell_feq string,
     cell_num int,
     gtusers int,
     commusers int,
     cellavguses int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;


DROP TABLE IF EXISTS TB_XDR_IFC_UU ;
CREATE EXTERNAL TABLE   IF NOT EXISTS  TB_XDR_IFC_UU (
      PARENTXDRID                  STRING,
      LENGTH                       BIGINT,
      CITY                         STRING,
      INTERFACE                     INT,
      XDRID                         STRING,
      RAT                           BIGINT,
      IMSI                          STRING,
      IMEI                          STRING,
      MSISDN                        STRING,
      PROCEDURETYPE                 INT,
      PROCEDURESTARTTIME            BIGINT, -- STRING,
      PROCEDUREENDTIME              BIGINT, -- STRING,
      KEYWORD1                      INT,
      KEYWORD2                      INT,
      PROCEDURESTATUS               INT,
      PLMNID                        STRING,
      ENBID                         BIGINT,
      CELLID                        BIGINT,
      CRNTI                         BIGINT,
      TARGETENBID                   BIGINT,
      TARGETCELLID                  BIGINT,
      TARGETCRNTI                   BIGINT,
      MMEUES1APID                   BIGINT,
      MMEGROUPID                    BIGINT,
      MMECODE                       BIGINT,
      MTMSI                         BIGINT,
      CSFBINDICATION                BIGINT,
      REDIRECTEDNETWORK             BIGINT,
      EPSBEARERNUMBER               INT,
      BEARER0ID                     BIGINT,
      BEARER0STATUS                 BIGINT,
      BEARER1ID                     BIGINT,
      BEARER1STATUS                 BIGINT,
      BEARER2ID                     BIGINT,
      BEARER2STATUS                 BIGINT,
      BEARER3ID                     BIGINT,
      BEARER3STATUS                 BIGINT,
      BEARER4ID                     BIGINT,
      BEARER4STATUS                 BIGINT,
      BEARER5ID                     BIGINT,
      BEARER5STATUS                 BIGINT,
      BEARER6ID                     BIGINT,
      BEARER6STATUS                 BIGINT,
      BEARER7ID                     BIGINT,
      BEARER7STATUS                 BIGINT,
      BEARER8ID                     BIGINT,
      BEARER8STATUS                 BIGINT,
      BEARER9ID                     BIGINT,
      BEARER9STATUS                 BIGINT,
      BEARER10ID                     STRING,
      BEARER10STATUS                 STRING,
      BEARER11ID                     STRING,
      BEARER11STATUS                 STRING,
      BEARER12ID                     STRING,
      BEARER12STATUS                 STRING,
      BEARER13ID                     STRING,
      BEARER13STATUS                 STRING,
      BEARER14ID                     STRING,
      BEARER14STATUS                 STRING,
      BEARER15ID                     STRING,
      BEARER15STATUS                 STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${DB_PATH}/TB_XDR_IFC_UU';

DROP TABLE   IF EXISTS lte_mro_source;
create EXTERNAL table   IF NOT EXISTS lte_mro_source
(
       objectID       STRING ,
       VID             BIGINT  ,
       fileFormatVersion STRING ,
       startTime       STRING  ,
       endTime         STRING ,
       period          BIGINT ,
       enbID           BIGINT,
       userLabel      STRING ,
       mrName         STRING ,
       cellID          BIGINT ,
       Earfcn          BIGINT ,
       SubFrameNbr     BIGINT ,
       PRBNbr          BIGINT ,
       MmeUeS1apId     BIGINT ,
       MmeGroupId      BIGINT ,
       MmeCode         BIGINT ,
       meaTime         STRING ,
       EventType      STRING ,
       gridcenterLongitude   STRING,
       gridcenterLatitude    STRING,
       kpi1            BIGINT ,
       kpi2            BIGINT ,
       kpi3            BIGINT ,
       kpi4            BIGINT ,
       kpi5            BIGINT ,
       kpi6            BIGINT ,
       kpi7            BIGINT ,
       kpi8            BIGINT ,
       kpi9            BIGINT ,
       kpi10           BIGINT ,
       kpi11           BIGINT ,
       kpi12           BIGINT ,
       kpi13           BIGINT ,
       kpi14           BIGINT ,
       kpi15           BIGINT ,
       kpi16           BIGINT ,
       kpi17           BIGINT ,
       kpi18           BIGINT ,
       kpi19           BIGINT ,
       kpi20           BIGINT ,
       kpi21           BIGINT ,
       kpi22           BIGINT ,
       kpi23           BIGINT ,
       kpi24           BIGINT ,
       kpi25           BIGINT ,
       kpi26           BIGINT ,
       kpi27           BIGINT ,
       kpi28           BIGINT ,
       kpi29           BIGINT ,
       kpi30           BIGINT ,
       kpi31           BIGINT ,
       kpi32           BIGINT ,
       kpi33           BIGINT ,
       kpi34           BIGINT ,
       kpi35           BIGINT ,
       kpi36           BIGINT ,
       kpi37           BIGINT ,
       kpi38           BIGINT ,
       kpi39           BIGINT ,
       kpi40           BIGINT ,
       kpi41           BIGINT ,
       kpi42           BIGINT ,
       kpi43           BIGINT ,
       kpi44           BIGINT ,
       kpi45           BIGINT ,
       kpi46           BIGINT ,
       kpi47           BIGINT ,
       kpi48           BIGINT ,
       kpi49           BIGINT ,
       kpi50           BIGINT ,
       kpi51           BIGINT ,
       kpi52           BIGINT ,
       kpi53           BIGINT ,
       kpi54           BIGINT ,
       kpi55           BIGINT ,
       kpi56           BIGINT ,
       kpi57           BIGINT ,
       kpi58           BIGINT ,
       kpi59           BIGINT ,
       kpi60           BIGINT ,
       kpi61           BIGINT ,
       kpi62           BIGINT ,
       kpi63           BIGINT ,
       kpi64           BIGINT ,
       kpi65           BIGINT ,
       kpi66           BIGINT ,
       kpi67           BIGINT ,
       kpi68           BIGINT ,
       kpi69           BIGINT ,
       kpi70           BIGINT ,
       kpi71           BIGINT ,
       length          BIGINT ,
       City            STRING ,
       XDRType         BIGINT ,
       Interface       BIGINT ,
       XDRID          STRING ,
       RAT             BIGINT ,
       IMSI           STRING ,
       IMEI           STRING ,
       MSISDN         STRING ,
       MRType          BIGINT ,
       NeighborCellNumber BIGINT ,
       gsmNeighborCellNumber   BIGINT ,
       tdsNeighborCellNumber   BIGINT ,
       v_enb BIGINT,
     mrtime   BIGINT
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${DB_PATH}/LTE_MRO_SOURCE';


DROP TABLE  IF EXISTS TB_XDR_IFC_GMMWMGMIMJISC;
CREATE EXTERNAL TABLE   IF NOT EXISTS TB_XDR_IFC_GMMWMGMIMJISC (
      LENGTH                        BIGINT,
      CITY                         STRING,
      INTERFACE                     BIGINT,
      XDRID                        STRING,
      RAT                           BIGINT,
      IMSI                         STRING,
      IMEI                         STRING,
      MSISDN                       STRING,
      PROCEDURETYPE                 BIGINT,
      PROCEDURESTARTTIME           BIGINT,
      PROCEDUREENDTIME             BIGINT,
      SERVICETYPE                   BIGINT,
      PROCEDURESTATUS               BIGINT,
      CALLINGNUMBER                STRING,
      CALLEDNUMBER                 STRING,
      CALLINGPARTYURI              STRING,
      REQUESTURI                   STRING,
      USERIP                       STRING,
      CALLID                       STRING,
      ICID                         STRING,
      SOURCENEIP                   STRING,
      SOURCENEPORT                  BIGINT,
      DESTNEIP                     STRING,
      DESTNEPORT                    BIGINT,
      CALLSIDE                      BIGINT,
      SOURCEACCESSTYPE              BIGINT,
      SOURCEECI                     BIGINT,
      SOURCETAC                     BIGINT,
      SOURCEIMSI                   STRING,
      SOURCEIMEI                   STRING,
      DESTACCESSTYPE                BIGINT,
      DESTECI                       BIGINT,
      DESTTAC                       BIGINT,
      DESTIMSI                     STRING,
      DESTIMEI                     STRING,
      AUTHTYPE                      BIGINT,
      EXPIRESTIMEREQ               BIGINT,
      EXPIRESTIMERSP               BIGINT,
      CALLINGSDPIPADDR             STRING,
      CALLINGAUDIOSDPPORT           BIGINT,
      CALLINGVIDEOSDPPORT           BIGINT,
      CALLEDSDPIPADDR              STRING,
      CALLEDAUDIOSDPPORT            BIGINT,
      CALLEDVIDEOPORT               BIGINT,
      AUDIOCODEC                    BIGINT,
      VIDEOCODEC                    BIGINT,
      REDIRECTINGPARTYADDRESS      STRING,
      ORIGINALPARTYADDRESS         STRING,
      REDIRECTREASON                BIGINT,
      RESPONSECODE                  BIGINT,
      FINISHWARNINGCODE             BIGINT,
      FINISHREASONPROTOCOL          BIGINT,
      FINISHREASONCAUSE             BIGINT,
      FIRFAILTIME                  BIGINT,
      FIRSTFAILNEIP                STRING,
      ALERTINGTIME                 BIGINT,
      ANSWERTIME                   BIGINT,
      RELEASETIME                  BIGINT,
      CALLDURATION                  BIGINT,
      AUTHREQTIME                  BIGINT,
      AUTHRSPTIME                  BIGINT,
      STNSR                        STRING,
      ATCFMGMT                     STRING,
      ATUSTI                       STRING,
      CMSISDN                      STRING,
      SSI                          STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${DB_PATH}/TB_XDR_IFC_GMMWMGMIMJISC';


drop table tac_hour_http;
CREATE EXTERNAL TABLE tac_hour_http(
time                        string,
tac                         string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/tac_hour_http';

drop table tac_day_http;
CREATE EXTERNAL TABLE tac_day_http(
time                        string,
tac                         string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/tac_day_http';

drop table cell_hour_http;
CREATE EXTERNAL TABLE cell_hour_http(
time                        string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/cell_hour_http';

drop table cell_day_http;
CREATE EXTERNAL TABLE cell_day_http(
time                        string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/cell_day_http';


drop table sp_hour_http;
CREATE EXTERNAL TABLE sp_hour_http(
time                        string,
appserveripipv4             string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/sp_hour_http';

drop table sp_day_http;
CREATE EXTERNAL TABLE sp_day_http(
time                        string,
appserveripipv4             string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/sp_day_http';


drop table ue_hour_http;
CREATE EXTERNAL TABLE ue_hour_http(
time                        string,
imsi                        string,
msisdn                      string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/ue_hour_http';


drop table ue_day_http;
CREATE EXTERNAL TABLE ue_day_http(
time                        string,
imsi                        string,
msisdn                      string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/ue_day_http';

drop table imsi_cell_hour_http;
CREATE EXTERNAL TABLE imsi_cell_hour_http(
time                        string,
imsi                        string,
msisdn                      string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/imsi_cell_hour_http';

drop table imsi_cell_day_http;
CREATE EXTERNAL TABLE imsi_cell_day_http(
time                        string,
imsi                        string,
msisdn                      string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/imsi_cell_day_http';

drop table sgw_hour_http;
CREATE EXTERNAL TABLE sgw_hour_http(
time                        string,
sgwipaddr                   string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/sgw_hour_http';

drop table sgw_day_http;
CREATE EXTERNAL TABLE sgw_day_http(
time                        string,
sgwipaddr                   string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
imFechatFlow                        int,
imFechatTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayNFCsucc                          int,
PayNFCreq                           int,
PayNFCresptimeall                   int,
PayNFCresp                          int,
PayNFCdownflow                      int,
PayNFCdowntime                      int,
PayNFCFlow                          int,
PayNFCTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/sgw_day_http';

drop table warnningtable;
CREATE EXTERNAL TABLE warnningtable(
City  int,
Cellid   bigint,
warnningtitle    string,
warnningtime     string,
effect           string
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/warnningtable';

drop table t_xdr_event_msg;
CREATE EXTERNAL TABLE t_xdr_event_msg(
City   int,
XDRID  string,
ProcedureStartTime bigint,
ttime string,
ProcedureEndTime  bigint,
IMSI             string,
TAC              bigint,
Cellid           bigint,
SGW             string,
SP              string,
AppType         int,
AppSubtype      int,
AppStatus       int,
exceptiontype   string,
failurecase     string,
errorbelong     string
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/t_xdr_event_msg';


drop table LTECELL;
create table LTECELL(
  MCC         int,
  MNC         INT,
  MMEGROUPID  INT,
  MMEID       int,
  ENODEBID    int,
  SITENAME    STRING,
  CELLNAME    STRING,
  LOCALCELLID int,
  CELLID      int,
  TAI         INT,
  PCI         INT,
  FREQ1       INT,
  FREQ2       INT,
  BANDWIDTH1  double,
  BANDWIDTH2  double,
  FREQCOUNT   INT,
  LONGITUDE   double,
  LATITUDE    double,
  SECTORTYPE  int,
  DOORTYPE    INT,
  TILTTOTAL   DOUBLE,
  TILTM       DOUBLE,
  TILTE       DOUBLE,
  AZIMUTH     DOUBLE,
  BEAMWIDTH   DOUBLE,
  VBEAMWIDTH  DOUBLE,
  AHEIGHT     DOUBLE,
  CITY        string,
  COMPANY     string,
  REGION      string,
  ENBTYPE     string,
  ENBVERSION  string
  )ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table business_type_detail;
create EXTERNAL table business_type_detail(
        TTIME              string,
        city               string,
        region             string,
        CELLID             int,
        app_type           string,
        app_sub_type       string,
        uldata             bigint,
        dldata             bigint
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/$WAREHOUSE/business_type_detail';

--门限配置表
 drop table if exists gt_capacity_config;
 create table gt_capacity_config(
        sub_pulse_limit int,
        non_gtsubpulse_commusers int,
        non_gtsubpuse_times int,
        over_pulse_timelen int,
        over_pulse_times int,
        short_pulse_timelen int,
        short_pulse_times int,
        balence_userrate int,
        balence_times int,
        highattach_users int,
        highattach_times int
 )
 PARTITIONED BY (
    dt string,
    h string
 )
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ','
LOCATION
    'hdfs://dtcluster/$WAREHOUSE/gt_capacity_config';

--负载均衡效果差小区天级表
drop table if exists gt_balence_baseday;
create table gt_balence_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        f1_f2 string,
        balenusesrateavg int,
        balenusersavg int
)
 PARTITIONED BY (
   dt string,
   h string
 )
 ROW FORMAT DELIMITED  FIELDS TERMINATED BY ','
 LOCATION
     'hdfs://dtcluster/$WAREHOUSE/gt_balence_baseday';

--高铁用户脉冲时长超短小区表
drop table if exists gt_shorttimelen_baseday;
create table gt_shorttimelen_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        minpluse_timelen string,
        maxpluse_timelen string
)
PARTITIONED BY (
    dt string,
    h string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ','
 LOCATION
     'hdfs://dtcluster/$WAREHOUSE/gt_shorttimelen_baseday';

--高铁用户脉冲时长超长小区表
drop table if exists gt_overtimelen_baseday;
create table gt_overtimelen_baseday(
        line_name  varchar2(50),
        city string,
        ttime string,
        cellid int,
        cellname string,
        minpluse_timelen int,
        maxpluse_timelen int
)
PARTITIONED BY (
    dt string,
    h string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ','
 LOCATION
     'hdfs://dtcluster/$WAREHOUSE/gt_overtimelen_baseday';

--平时普通用户多小区天级表
drop table if exists gt_commusermore_baseday;
create table gt_commusermore_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        maxusers int
)
PARTITIONED BY (
    dt string,
    h string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ','
 LOCATION
     'hdfs://dtcluster/$WAREHOUSE/gt_commusermore_baseday';

--高冲击小区维度天级详细表
drop table if exists gt_highattach_baseday;
create table gt_highattach_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        maxusers int
)
PARTITIONED BY (
    dt string,
    h string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ','
 LOCATION
     'hdfs://dtcluster/$WAREHOUSE/gt_highattach_baseday';
EOF
exit 0

